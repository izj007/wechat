#  （CVE-2022-29072）7zip漏洞EXP

骨哥说事  [ 骨哥说事 ](javascript:void\(0\);)

**骨哥说事** ![]()

微信号 guge_guge

功能介绍 关注信息安全趋势，发布国内外网络安全事件，不定期发布对热点事件的个人见解。

____

__

收录于话题

#漏洞 2 个

#0day 2 个

#7zip 1 个

骨哥个人观点，该漏洞比较适用于内网Windows提权。

  

 **CVE官方描述：**

  

Windows平台 7-Zip（v21.07） 允许将扩展名为 .7z 的文件被拖到HELP>contents时，可造成权限提升和命令执行。  

  

 **漏洞形成原因：**

 **  
**

7-zip 软件中包含的0day漏洞是基于 7z.dll 的错误配置和堆溢出，7-zip软件安装后，HELP
>contents内容中的帮助文件通过Windows HTML Helper工作，但命令注入后，7zFM.exe进程下出现子进程：

![](https://gitee.com/fuli009/images/raw/master/public/20220419113236.png)

这是在命令注入后所看到的，有趣的是，在这种情况下，7-zip与WinAFL的fuzzing过程被执行，由于基于堆的溢出漏洞和错误授权，当使用7z.dll文件的应用进程在内存中使用注入技术并再次调用命令提示符时，cmd.exe被授权为管理员模式，于是在这种情况下利用Powershell写相应的POC就水到渠成了。

 **  
**

 **修复方法：**

  

 **方法1：** 如果7-Zip没有更新，删除7-zip.chm文件足以关闭该漏洞

 **方法2：** 7-压缩程序应只赋予读取和运行权限(并适用于所有用户)

  

具体详见：https://github.com/kagancapar/CVE-2022-29072

  

点击下方“ **阅读原文** ”可直接跳转  

  

 ** **====正文结束====****

预览时标签不可点

收录于话题 #

 个

上一篇 下一篇

微信扫一扫  
关注该公众号

[知道了](javascript:;)

微信扫一扫  
使用小程序

****

[取消](javascript:void\(0\);) [允许](javascript:void\(0\);)

****

[取消](javascript:void\(0\);) [允许](javascript:void\(0\);)

： ， 。   视频 小程序 赞 ，轻点两下取消赞 在看 ，轻点两下取消在看

