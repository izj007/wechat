##  CVE-2021-34429：Jetty WEB-INF文件读取复现

原创 Menge  [ Timeline Sec ](javascript:void\(0\);)

**Timeline Sec** ![]()

微信号 TimelineSec

功能介绍 学安全必备，专注于最新漏洞复现与分析。（Timeline Sec 网络安全团队官方公众号）

____

__

收录于话题

#漏洞复现文章合集

101个

  

**上方蓝色字体关注我们，一起学安全！** **作者：Menge** **** **@Timeline Sec  
** **本文字数：907** **阅读时长：2～3min** **声明：仅供学习参考使用，请勿用作违法用途，否则后果自负**

  

 **0x01 简介**  
  
  

Jetty是一个开源的servlet容器，它为基于Java的web容器，例如JSP和servlet提供运行环境。Jetty是使用Java语言编写的，它的API以一组JAR包的形式发布。开发人员可以将Jetty容器实例化成一个对象，可以迅速为一些独立运行（stand-
alone）的Java应用提供网络和web连接。

  

 **0x02 漏洞概述**  
  
  

 **编号：CVE-2021-34429**  

可以使用一些编码字符来制作URI，以访问WEB-INF目录的内容和/或绕过一些安全限制。默认合规模式允许带有包含 %u002e 段的 URI
的请求访问WEB-INF目录中的受保护资源。  

  

例如，/%u002e/WEB-INF/web.xml可以检索 web.xml 文件的请求。这可能会泄露有关 Web
应用程序实现的敏感信息。同样，编码的空字符可能会阻止正确的规范化，因此/.%00/WEB-INF/web.xml也会检索 web.xml
文件。此漏洞是CVE-2021-28164和CVE-2021-28169的新的绕过方式。

  

 **0x03 影响版本**  
  
  

9.4.37 ≤ Eclipse Jetty ≤ 9.4.42  

10.0.1 ≤ Eclipse Jetty ≤ 10.0.5  

11.0.1 ≤ Eclipse Jetty ≤ 11.0.5

  

 **0x04 环境搭建**  
  
  

可以直接用vulhub项目直接搭建jetty9.4.40的环境，也可以自行搭建

  

项目地址 (版本是jetty9.4.40)  

  * 

    
    
    https://github.com/vulhub/vulhub/blob/master/jetty/CVE-2021-28164/

  

docker启动  

  *   * 

    
    
    cd /vulhub/jetty/CVE-2021-28164docker-compose up -d

  

然后访问http://your-ip:8080  

出现以下界面，搭建成功!

  

![](https://gitee.com/fuli009/images/raw/master/public/20210811084901.png)

  

 **0x05 漏洞复现**  
  
  

使用curl -I http://ip:port  

可以看到Jetty版本

  

![](https://gitee.com/fuli009/images/raw/master/public/20210811084903.png)

  

或是直接访问一个不存在的页面

  

![](https://gitee.com/fuli009/images/raw/master/public/20210811084909.png)

  

使用Burpsuite发送GET请求/%u002e/WEB-INF/web.xml即可读取到web.xml文件

  

![](https://gitee.com/fuli009/images/raw/master/public/20210811084910.png)

  

 **0x06 修复方式**  
  
  
  

1.使用补丁版本，如9.4.43, 10.0.6, 11.0.6

  

2.官网建议，可以部署一些 Jetty重写规则，将原始请求 URI
中包含编码点段或空字符的任何请求重写为已知未找到的资源（https://github.com/eclipse/jetty.project/security/advisories/GHSA-
vjv5-gp2w-65vm）  

  *   *   *   *   *   *   *   *   *   *   *   *   * 

    
    
    <Call name="addRule">  <Arg>    <New class="org.eclipse.jetty.rewrite.handler.RewriteRegexRule">      <Set name="regex">.*/(?:\.+/)+.*</Set>      <Set name="replacement">/WEB-INF/Not-Found</Set>    </New>  </Arg></Call><Call name="addRule">  <Arg>    <New class="org.eclipse.jetty.rewrite.handler.ValidUrlRule"/>  </Arg></Call>

  

    
    
     **参考链接：**

https://github.com/eclipse/jetty.project/security/advisories/GHSA-
vjv5-gp2w-65vm  

https://mp.weixin.qq.com/s/GUsPetS256WEL90PaSNKYA

  

![](https://gitee.com/fuli009/images/raw/master/public/20210811084911.png)  
![](https://gitee.com/fuli009/images/raw/master/public/20210811084912.png)
**阅读原文看更多复现文章** Timeline Sec 团队  
安全路上，与你并肩前行  
  
  
  
  
  
  
  

  
  
  
  

  

预览时标签不可点

收录于话题 #

个 __

上一篇 下一篇

阅读原文

阅读

分享 收藏

赞 在看

____已同步到看一看[写下你的想法](javascript:;)

前往“发现”-“看一看”浏览“朋友在看”

![](//res.wx.qq.com/mmbizwap/zh_CN/htmledition/images/pic/appmsg/pic_like_comment55871f.png)

前往看一看

**看一看入口已关闭**

在“设置”-“通用”-“发现页管理”打开“看一看”入口

[我知道了](javascript:;)

__

已发送

取消 __

####  发送到看一看

发送

CVE-2021-34429：Jetty WEB-INF文件读取复现

最多200字，当前共字

__

发送中

写下你的留言

微信扫一扫  
关注该公众号

微信扫一扫  
使用小程序

****

[取消](javascript:void\(0\);) [允许](javascript:void\(0\);)

****

[取消](javascript:void\(0\);) [允许](javascript:void\(0\);)

[知道了](javascript:;)

**长按识别前往小程序**

![]()

