#  å®æˆ˜ | æˆ‘å¦‚ä½•é€šè¿‡å‘ Facebook æäº¤æ¼æ´èµšå–31500ç¾å…ƒ

[ é»‘ç™½ä¹‹é“ ](javascript:void\(0\);)

**é»‘ç™½ä¹‹é“** ![]()

å¾®ä¿¡å· i77169

åŠŸèƒ½ä»‹ç» æˆ‘ä»¬æ˜¯ç½‘ç»œä¸–ç•Œçš„å¯æ˜æ˜Ÿï¼Œå®‰å…¨ä¹‹è·¯çš„å«è„šçŸ³ã€‚

____

___å‘è¡¨äº_

æ”¶å½•äºåˆé›†

![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230301101138.png)

## Facebookæ˜¯ä¸–ç•Œä¸Šæœ€å¤§çš„ç¤¾äº¤ç½‘ç«™ï¼Œä¹Ÿæ˜¯ä½¿ç”¨æœ€å¹¿æ³›çš„ç½‘ç«™ä¹‹ä¸€ã€‚

##  

## æˆ‘ä¸€ç›´å¯¹æµ‹è¯• Facebook çš„å®‰å…¨æ€§å¾ˆæ„Ÿå…´è¶£ã€‚åœ¨å­åŸŸæšä¸¾æœŸé—´ï¼Œæˆ‘æœ‰ä¸€ä¸ªå­åŸŸæ˜¯â€œ https://m-nexus.thefacebook.com/
â€

##  

## å®ƒå°†æˆ‘é‡å®šå‘åˆ°â€œ https://m-nexus.thefacebook.com/servlet/mstrWebAdmin â€œè§‚å¯Ÿä¸‹é¢çš„æˆªå›¾ï¼š  

![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230301101145.png)

æˆ‘å¿«é€Ÿæœç´¢å…³é”®å­—mstrWebAdminï¼Œå‘ç°è¿™æ˜¯åŸºäºMicroStrategyå·¥å…·æ„å»ºçš„å•†ä¸šæ™ºèƒ½é—¨æˆ·ï¼š

![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230301101149.png)

æˆ‘ç”¨åšå®¢è¯å®äº†è¿™ä¸€ç‚¹ï¼š

![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230301101150.png)

ä» MicroStrategy çš„å®˜æ–¹é…ç½®æ–‡æ¡£ä¸­ï¼Œæˆ‘å‘ç°æœ‰ä¸¤ä¸ªç«¯ç‚¹å¯ä»¥å…¬å¼€è®¿é—®ï¼š

![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230301101151.png)

è¿›ä¸€æ­¥æŸ¥çœ‹ MicroStrategy
çš„å®˜æ–¹é…ç½®æ–‡æ¡£ï¼Œæˆ‘å‘ç°é»˜è®¤æƒ…å†µä¸‹ï¼Œåœ¨å•†ä¸šæ™ºèƒ½é—¨æˆ·ï¼ˆURLï¼šhttps://m-nexus.thefacebook.com/servlet/mstrWeb
ï¼‰ä¸Šå¯ç”¨äº† HTTP åŸºæœ¬èº«ä»½éªŒè¯ï¼Œç„¶åæˆ‘è§‚å¯Ÿåˆ°

https://m-nexus.thefacebook.com/servlet/taskProc ä¸éœ€è¦èº«ä»½éªŒè¯ã€‚

å®ƒä»â€œ taskId â€å‚æ•°ä¸­è·å–å€¼æ¥æ‰§è¡Œä¸€äº›è‡ªå®šä¹‰æ•°æ®æ”¶é›†å’Œå†…å®¹ç”Ÿæˆã€‚é€šè¿‡æšä¸¾é¢„å»ºä»»åŠ¡ï¼ˆUsing
Intruderï¼‰ï¼Œæˆ‘å‘ç°æ¯ä¸ªé¢„å»ºä»»åŠ¡éƒ½ä¼šæ£€æŸ¥æœ‰æ•ˆçš„èº«ä»½éªŒè¯ä¼šè¯å‚æ•°ï¼Œä½†å¤„ç†çŸ­ URL ä¸”ä¸æ£€æŸ¥æœ‰æ•ˆèº«ä»½éªŒè¯ä¼šè¯çš„â€œ shortURL
â€ä»»åŠ¡ã€‚æ”»å‡»è€…å¯ä»¥ä½¿ç”¨æ­¤è§‚å¯Ÿæ¥è®¿é—®æ­¤æœåŠ¡è€Œæ— éœ€ä»»ä½•èº«ä»½éªŒè¯ã€‚

![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230301101152.png)

ä½¿ç”¨ Burp Suiteå…¥ä¾µè€…çš„é¢„å»ºä»»åŠ¡æšä¸¾

![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230301101153.png)

æˆ‘å¼€å§‹å¯¹å®˜æ–¹æ–‡æ¡£ä¸­æåˆ°çš„æ‰€æœ‰å‚æ•°è¿›è¡Œæ¨¡ç³Šæµ‹è¯•ï¼Œä½†æˆ‘ä»€ä¹ˆä¹Ÿæ²¡æ‰¾åˆ°ã€‚ğŸ˜” æ¯æ¬¡å®ƒç»™æˆ‘ä¸€æ¡é”™è¯¯æ¶ˆæ¯â€œ _æº URL æ— æ•ˆ_ â€ï¼ŒçŠ¶æ€ä»£ç ä¸º
500ã€‚ç„¶åæˆ‘æƒ³ï¼Œè®©æˆ‘ä»¬ä¸‹è½½æ‰˜ç®¡çš„ Web åº”ç”¨ç¨‹åºå¹¶å¼€å§‹æºä»£ç å®¡æŸ¥ã€‚æˆ‘ä¸‹è½½äº†ä¸€ä¸ª400å¤šMBçš„åº”ç”¨ç¨‹åºåŒ…ã€‚åŒ…ä¸­æœ‰å‡ ä¸ªè„šæœ¬å’Œ jar æ–‡ä»¶ã€‚

![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230301101157.png)

æˆ‘ç®€å•åœ°ä½¿ç”¨jd-guiå·¥å…·åç¼–è¯‘äº†é‚£ä¸ª jar æ–‡ä»¶å¹¶å¼€å§‹å®¡æŸ¥ä»£ç ã€‚æˆ‘çš„ä¸»è¦ç›®æ ‡æ˜¯shortURLä»»åŠ¡ï¼Œå®ƒå¤„ç†çŸ­ URL
å¹¶ä¸”ä¸æ£€æŸ¥æœ‰æ•ˆçš„èº«ä»½éªŒè¯ä¼šè¯ã€‚æœ€åæˆ‘ä»ä¸€ä¸ª jar æ–‡ä»¶ä¸­æ‰¾åˆ°äº†é‚£ä¸ª Java ç±»ã€‚

![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230301101158.png)

ç„¶åæˆ‘æ‰çŸ¥é“ä¸ºä»€ä¹ˆå®ƒæ¯æ¬¡éƒ½ç»™å‡ºç›¸åŒçš„é”™è¯¯æ¶ˆæ¯ï¼Œâ€œ shortURL â€ä»»åŠ¡çš„â€œ srcURL â€å‚æ•°ä»…é‡‡ç”¨ä½¿ç”¨â€œ https://tinyurl.com/
â€åˆ›å»ºçš„ URL æ¥å¯¼å…¥æ•°æ®æˆ–ä»ä¸­è¯»å–æ•°æ®è¯¥ URLã€‚è§‚å¯Ÿä»¥ä¸‹ä»£ç ç‰‡æ®µï¼š

![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230301101159.png)

å¤åˆ¶æ­¥éª¤ï¼ˆæˆ‘å‘é€åˆ° Facebook çš„å†…å®¹ï¼‰ï¼š  
1\. æ‰“å¼€ Burp Suiteä»£ç†å·¥å…·å¹¶è½¬åˆ° Burp èœå•å¹¶é€‰æ‹©â€œBurp Collaborator å®¢æˆ·ç«¯â€ã€‚ç”Ÿæˆ Collaborator
è´Ÿè½½å¹¶å°†å…¶å¤åˆ¶åˆ°å‰ªè´´æ¿ã€‚

![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230301101204.png)

2\. ä»ç½‘ç»œæµè§ˆå™¨æ‰“å¼€â€œhttps://tinyurl.com/â€ï¼Œè¾“å…¥åä½œè€…è´Ÿè½½å¹¶åˆ›å»ºå…¶å¾®å‹ URLã€‚å¤åˆ¶åˆ›å»ºçš„å¾®å‹ URLã€‚

![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230301101205.png)

3\. åœ¨ä»¥ä¸‹ URL çš„â€œsrcURLâ€å‚æ•°ä¸­æ’å…¥å¤åˆ¶çš„â€œtiny URLâ€å¹¶åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€å®ƒï¼š  
https://m-nexus.thefacebook.com/servlet/taskProc?taskId=shortURL&taskEnv=xml&taskContentType=json&srcURL={YOUR_TINY_URL_HERE}

![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230301101206.png)

4\. è§‚å¯Ÿ Burp Collaborator ç«‹å³ç‚¹å‡»ï¼Œå®ƒæ˜¾ç¤ºæ”¶åˆ°è¯·æ±‚çš„IP åœ°å€â€œ 199.201.64.1 â€ã€‚

![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230301101207.png)

è¿™è¡¨æ˜å­˜åœ¨å¤–éƒ¨SSRFæ¼æ´ã€‚

5\. IP â€” 199.201.64.1 å±äº Facebookï¼Œå·²é€šè¿‡ whois è®°å½•ç¡®è®¤ã€‚

![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230301101208.png)

6\. æµ‹è¯•å†…éƒ¨ SSRFï¼šåˆ›å»ºæ— æ•ˆå†…éƒ¨ IP åœ°å€çš„å¾®å‹ URLï¼ˆä¾‹å¦‚ 123.10.123.10ï¼‰ï¼Œå°†å…¶æ’å…¥â€œsrcURLâ€å‚æ•°å¹¶è§‚å¯ŸæœåŠ¡å™¨æ²¡æœ‰å“åº”ã€‚

![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230301101210.png)

7\. å†æ¬¡åˆ›å»ºæœ‰æ•ˆå†…éƒ¨ IP åœ°å€ (127.0.0.1:8080) çš„å¾®å‹ URLï¼Œå°†å…¶æ’å…¥â€œsrcURLâ€å‚æ•°å¹¶è§‚å¯Ÿå®ƒæ˜¯å¦è¯·æ±‚ HTTP
åŸºæœ¬èº«ä»½éªŒè¯ã€‚

![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230301101212.png)

é€šè¿‡è¿™ç§è§‚å¯Ÿï¼Œæˆ‘ä»¬å¯ä»¥æšä¸¾é˜²ç«å¢™ç¯å¢ƒèƒŒåçš„å†…éƒ¨åŸºç¡€è®¾æ–½ã€‚æˆ‘å¾ˆå¿«å‘ Facebook æŠ¥å‘Šäº†æˆ‘çš„å‘ç°ï¼Œä½†è¢«æ‹’ç»äº†ï¼Œå› ä¸ºä»–ä»¬è®¤ä¸ºè¿™ä¸æ˜¯å®‰å…¨æ¼æ´ã€‚è§‚å¯Ÿä»¥ä¸‹å“åº”ï¼š

![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230301101214.png)

  

#  **æ·±å…¥æŒ–æ˜  **

 **  
**

æˆ‘å¿…é¡»æ‹¿å‡ºè¯æ®ã€‚æˆ‘å°è¯•ä½¿ç”¨ URL æ¶æ„ï¼ˆå¦‚ file://ã€dict://ã€ftp://ã€gopher://
ç­‰ï¼‰è¯»å–å†…éƒ¨ä¿¡æ¯ã€‚è¿˜å°è¯•è·å–äº‘å®ä¾‹çš„å…ƒæ•°æ®ä½†æ²¡æœ‰æˆåŠŸã€‚

ä¸€æ®µæ—¶é—´åï¼Œæˆ‘ç»ˆäºæƒ³å‡ºäº†ä¸€äº›æœ‰å½±å“åŠ›çš„ä¾‹å­ã€‚ä»¥ä¸‹æ˜¯æˆ‘å‘é€ç»™ Facebook çš„ä¸€äº›å®æ—¶æ”»å‡»åœºæ™¯ä»¥åŠé‡ç°æ­¥éª¤ï¼š

## 1\. åå°„å‹è·¨ç«™è„šæœ¬ï¼ˆXSSï¼‰ï¼š

![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230301101215.png)

## 2.å€ŸåŠ©SSRFçš„é’“é±¼æ”»å‡»ï¼š

æ­¥éª¤ 1.åˆ›å»ºå¹¶æ‰˜ç®¡ä¸€ä¸ª Facebook ç™»å½•çš„é’“é±¼é¡µé¢ï¼Œçªƒå–å—å®³è€…çš„ Facebook ç™»å½•å‡­æ®ï¼Œçœ‹èµ·æ¥åƒä¸€ä¸ªåˆæ³•çš„ç™»å½•é—¨æˆ·ã€‚

![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230301101216.png)

æˆ‘å°†å®ƒæ‰˜ç®¡åœ¨ç§äººæœåŠ¡å™¨ä¸Šï¼Œå³http://ahmedabadexpress.co.in/

æ­¥éª¤ 2.ä» Web æµè§ˆå™¨æ‰“å¼€â€œ https://tinyurl.com/ â€ï¼Œåˆ›å»ºä¸€ä¸ªæ‰˜ç®¡é’“é±¼é¡µé¢çš„å° URLï¼Œå³â€œ
http://ahmedabadexpress.co.in/fb/login/fb.html â€ã€‚å¤åˆ¶åˆ›å»ºçš„å° URLã€‚

![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230301101217.png)

æ­¥éª¤ 3.åœ¨ä»¥ä¸‹ URL çš„â€œsrcURLâ€å‚æ•°ä¸­æ’å…¥å¤åˆ¶çš„â€œtiny URLâ€å¹¶å‘é€ç»™å—å®³è€…ï¼š  

  * 

    
    
    https ://m-nexus.thefacebook.com/servlet/taskProc?taskId=shortURL&taskEnv=xml&taskContentType=json&srcURL={YOUR_TINY_URL_HERE }

![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230301101219.png)

ä¸€æ—¦å—å®³è€…åœ¨æ­¤é¡µé¢ä¸Šè¾“å…¥ä»–/å¥¹çš„ç”¨æˆ·åå’Œå¯†ç ï¼Œå®ƒå°±ä¼šè¢«ä¿å­˜åˆ°â€œ http:
//ahmedabadexpress.co.in/fb/login/usernames.txt â€æ–‡ä»¶ä¸­ã€‚å—å®³è€…å°†è¢«é‡å®šå‘åˆ°çœŸå®çš„ Facebook
ç™»å½•é¡µé¢ã€‚ä½ å¯ä»¥çœ‹åˆ°ä¸»æœºåæ˜¯å­—ç¬¦ä¸²â€œm-nexus.thefacebook.comâ€æ‰€ä»¥å®ƒçœ‹èµ·æ¥æ˜¯åˆæ³•çš„ã€‚

æ­¥éª¤ 4.

å¯¼èˆªåˆ°http://ahmedab adexpress.co.in/fb/login/usernames.txt

URL å¹¶è§‚å¯Ÿè¢«ç›—å‡­è¯ã€‚

![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230301101221.png)

æ”»å‡»è€…è¿˜å¯èƒ½ä½¿ç”¨æ­¤æ¼æ´å°†ç”¨æˆ·é‡å®šå‘åˆ°å…¶ä»–ç”¨äºæœåŠ¡æ¶æ„è½¯ä»¶å’Œç±»ä¼¼æ”»å‡»çš„æ¶æ„ç½‘é¡µã€‚

## 3.æŒ‡çº¹å†…éƒ¨ï¼ˆéäº’è”ç½‘æš´éœ²ï¼‰ç½‘ç»œæ„ŸçŸ¥æœåŠ¡ï¼š

æˆ‘èƒ½å¤Ÿæ‰«æé˜²ç«å¢™åé¢çš„å†…éƒ¨ç½‘ç»œã€‚æˆ‘ä½¿ç”¨ burp suite intruder å‘é€äº†è¶…è¿‡ 10000
ä¸ªè¯·æ±‚æ¥æŸ¥æ‰¾æœåŠ¡å™¨ä¸Šçš„å¼€æ”¾ç«¯å£æˆ–åœ¨è¯¥ç«¯å£ä¸Šè¿è¡Œçš„ä»»ä½•åº”ç”¨ç¨‹åºã€‚

![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230301101222.png)

ç»è¿‡æ‰«æï¼Œæˆ‘ç»ˆäºæ‰¾åˆ°äº†ä¸€ä¸ªè¿è¡Œåœ¨10303ç«¯å£çš„åä¸ºâ€œ LightRay â€çš„åº”ç”¨ç¨‹åºã€‚

![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230301101224.png)

åœ¨æˆ‘å¯¹æ­¤è¿›è¡Œè¿›ä¸€æ­¥è°ƒæŸ¥ä¹‹å‰ï¼ŒFacebook å®‰å…¨å›¢é˜Ÿè§£å†³äº†è¯¥æ¼æ´ã€‚

æœ€åï¼š

![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230301101225.png)

##  **æ•…äº‹æ‰åˆšåˆšå¼€å§‹**

 **  
**

ç°åœ¨æˆ‘çŸ¥é“ MicroStrategy Web SDK æ‰˜ç®¡åœ¨ Facebook çš„ç”Ÿäº§æœåŠ¡å™¨ä¸Šã€‚MicroStrategy Web SDK æ˜¯ç”¨ Java
ç¼–ç¨‹è¯­è¨€ç¼–å†™çš„ï¼Œæˆ‘å–œæ¬¢åœ¨ Java ä»£ç ä¸­æŸ¥æ‰¾é”™è¯¯ã€‚ äºæ˜¯ï¼Œæˆ‘ä½¿ç”¨JD
Decompilerå·¥å…·åç¼–è¯‘äº†SDKçš„å„ä¸ªjaræ–‡ä»¶ï¼Œå¼€å§‹reviewä»£ç ã€‚æˆ‘è¿˜åœ¨æˆ‘çš„æœåŠ¡å™¨ä¸Šæ‰˜ç®¡äº†
SDKï¼Œè¿™æ ·å¦‚æœæˆ‘å‘ç°ä»£ç ä¸­æœ‰ä»»ä½•å¯ç–‘ä¹‹å¤„ï¼Œæˆ‘å¯ä»¥åœ¨é‚£é‡Œæ£€æŸ¥ã€‚

ç»è¿‡26å¤©çš„å‹¤å¥‹å’Œæ‰“ç£¨ï¼Œç»ˆäºå¾—åˆ°äº†ä¸€ä¸ªæœ‰è¶£çš„è§‚å¯Ÿç»“æœã€‚

åœ¨â€œcom.microstrategy.web.app.task.WikiScrapperTaskâ€ç±»ä¸­ï¼Œæˆ‘è§‚å¯Ÿåˆ°å­—ç¬¦ä¸²â€œstr1â€æ˜¯ç”±æˆ‘ä»¬ä½œä¸ºå‚æ•°å‘é€çš„ç”¨æˆ·æä¾›çš„è¾“å…¥åˆå§‹åŒ–çš„ã€‚å®ƒå°†æ£€æŸ¥æä¾›çš„å­—ç¬¦ä¸²æ˜¯å¦ä»¥
http://ï¼ˆæˆ–https://ï¼‰å¼€å¤´ï¼Œå¦‚æœæ˜¯ï¼Œé‚£ä¹ˆå®ƒå°†è°ƒç”¨å‡½æ•°â€œwebScrapperâ€ã€‚

![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230301101226.png)

â€œwebScrapperâ€å‡½æ•°å°†åœ¨å†…éƒ¨ä½¿ç”¨ JSOUP å‘æä¾›çš„ URL å‘é€ GET è¯·æ±‚ã€‚å®ƒç”¨äºè·å–å’Œè§£æ HTML é¡µé¢ã€‚

![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230301101228.png)

åˆæ˜¯ SSRF..

  

![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230301101229.png)

![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230301101230.png)

ä¸å¹¸çš„æ˜¯ï¼Œè¿™æ¬¡æ˜¯ä¸€ä¸ªç›²ç›®çš„ SSRFï¼Œæ‰€ä»¥æˆ‘æ— æ³•è¯æ˜å®ƒå…è®¸æäº¤å†…éƒ¨ GET è¯·æ±‚ã€‚ä½†æ˜¯ï¼Œä» MicroStrategy Web SDKï¼ˆéƒ¨ç½²åœ¨åŸŸ
m-nexus.thefacebook.com ä¸Šï¼‰çš„æºä»£ç ä¸­ï¼Œæˆ‘ç¡®è®¤è¿™æ˜¯ä¸€ä¸ªå†…éƒ¨ SSRFã€‚

æ ¹æ®è¿™ä¸€è§‚å¯Ÿï¼Œæˆ‘ä»¬æ— æ³•æšä¸¾é˜²ç«å¢™ç¯å¢ƒèƒŒåçš„å†…éƒ¨åŸºç¡€è®¾æ–½ï¼Œä¹Ÿæ— æ³•æ³„éœ²ä»»ä½•æ•æ„Ÿä¿¡æ¯ã€‚æˆ‘çŸ¥é“å¦‚æœæˆ‘å‘ Facebook
æŠ¥å‘Šè¿™ä¸ªï¼Œä»–ä»¬ä¼šæ‹’ç»ï¼Œå› ä¸ºè¿™ä¸ªæ¼æ´æ²¡æœ‰å½±å“ã€‚

é‚£ä¹ˆä¸‹ä¸€æ­¥æ˜¯ä»€ä¹ˆï¼Ÿâ€”â€”æˆ‘è¿™ä¼šå„¿è„‘å­ä¸€ç‰‡ç©ºç™½ï¼

![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230301101232.png)

æˆ‘ç¦»å¼€å®ƒå¹¶å¼€å§‹åœ¨ Facebook ä¸»åŸŸ (facebook.com) ä¸­å¯»æ‰¾æ–°çš„æ¼æ´

  

##  **å‡ ä¸ªæœˆå...**

æˆ‘åœ¨ Facebook ä¸Šå‘ç°äº†å¦ä¸€ä¸ªæ¼æ´ï¼Œå…¶ä¸­ URL ç¼©çŸ­å™¨å¯èƒ½ä¼šæ³„éœ²æœ‰å…³æœåŠ¡å™¨çš„æ•æ„Ÿä¿¡æ¯ã€‚

  * 

    
    
    URL ç¼©çŸ­æ˜¯ä¸‡ç»´ç½‘ä¸Šçš„ä¸€é¡¹æŠ€æœ¯ï¼Œå…¶ä¸­å¯ä»¥ä½¿ç»Ÿä¸€èµ„æºå®šä½ç¬¦å¤§å¤§ç¼©çŸ­ï¼Œä½†ä»å¯ç›´æ¥æŒ‡å‘æ‰€éœ€é¡µé¢ã€‚-ç»´åŸºç™¾ç§‘

Facebook åœ¨https://fb.me/ä¸Šæœ‰è‡ªå·±çš„ URL ç¼©çŸ­æœåŠ¡ã€‚æ­¤ URL ç¼©çŸ­æœåŠ¡ä¾›å†…éƒ¨ï¼ˆFacebook å‘˜å·¥ï¼‰å’Œå…¬å…±ç”¨æˆ·ä½¿ç”¨ã€‚æˆ‘æ³¨æ„åˆ°çŸ­
URL åªä¼šä½¿ç”¨ HTTP Location æ ‡å¤´å°†ç”¨æˆ·é‡å®šå‘åˆ°é•¿
URLã€‚æˆ‘è§‚å¯Ÿåˆ°ç½‘ç«™â€œfb.meâ€æ²¡æœ‰è®¾ç½®é€Ÿç‡é™åˆ¶ã€‚æˆ‘æ­£åœ¨å¯»æ‰¾ç°æœ‰çš„ï¼ˆå’Œ/æˆ–éšè—çš„ï¼‰ç½‘ç»œç›®å½•å’Œæ–‡ä»¶ã€‚æˆ‘é’ˆå¯¹è¯¥ Web æœåŠ¡å™¨å‘èµ·äº†åŸºäºå­—å…¸çš„æš´åŠ›æ”»å‡»ï¼ˆå¤§çº¦
2000 ä¸ªå•è¯ï¼‰å¹¶åˆ†æäº†å“åº”ã€‚åœ¨ burp suite intruder
çš„å¸®åŠ©ä¸‹ï¼Œæˆ‘æ•è·äº†å‡ ä¸ªçŸ­é“¾æ¥ï¼Œè¿™äº›é“¾æ¥å°†ç”¨æˆ·é‡å®šå‘åˆ°å†…éƒ¨ç³»ç»Ÿï¼Œä½†å†…éƒ¨ç³»ç»Ÿä¼šå°†ç”¨æˆ·é‡å®šå‘åˆ° Facebook ä¸»åŸŸï¼ˆå³ facebook.comï¼‰ã€‚

è¿™æ˜¯ä¸€ä¸ªåœºæ™¯ï¼š

  *   *   *   * 

    
    
    https://fb.me/xyz ==> 301 æ°¸ä¹…ç§»åŠ¨ â€” https://our.intern.facebook.com/intern/{some-internal-data } ==> 302 æ‰¾åˆ° â€” https://www.facebook .com/intern/{some-internal-data } ==> 404 Not Found

è¯·æ³¨æ„ï¼Œä¸€äº›å°†ç”¨æˆ·é‡å®šå‘åˆ°å†…éƒ¨ç³»ç»Ÿçš„çŸ­é“¾æ¥æ˜¯ç”± Facebook å†…éƒ¨äººå‘˜ç”Ÿæˆçš„ã€‚å®ƒå¯èƒ½åŒ…å«æ•æ„Ÿçš„å†…éƒ¨ä¿¡æ¯ã€‚ä¾‹å¦‚

  * 

    
    
    https://our.intern.facebook.com/intern/webmanager?domain=xyz.com&user=admin& token=YXV0aGVudGljYXRpb24gdG9rZW4g

![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230301101233.png)

åœ¨ burp Suiteä»£ç†å·¥å…·ä¸­è§‚å¯Ÿhttps://fb.me/err URL çš„ HTTP å“åº”ï¼Œå®ƒæ˜¾ç¤ºæ—¥å¿—æ–‡ä»¶å¤¹çš„å†…éƒ¨å®Œæ•´è·¯å¾„ã€‚

æˆ‘å·²ç»èƒ½å¤Ÿä½¿ç”¨å•è¯åˆ—è¡¨å’Œå…¥ä¾µè€…è·å¾—æ›´å¤šè¿™æ ·çš„ä¿¡æ¯ã€‚æˆ‘åˆ›å»ºäº†ä¸€ä¸ªç®€å•çš„ python è„šæœ¬æ¥è‡ªåŠ¨æ‰§è¡Œæ­¤ä»»åŠ¡ã€‚

![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230301101234.png)

è§‚å¯Ÿä¸‹é¢æˆ‘åœ¨æµ‹è¯•æœŸé—´è·å¾—çš„ä¿¡æ¯çš„å±å¹•æˆªå›¾ã€‚

![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230301101236.png)

![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230301101240.png)

  

æˆ‘åªæ·»åŠ äº†ä¸¤ä¸ªå±å¹•æˆªå›¾ã€‚ç”±äº Facebook çš„æ”¿ç­–ï¼Œæˆ‘ä¸èƒ½é€éœ²æ‰€æœ‰ä¿¡æ¯ã€‚æ­¤æ¼æ´ä¼šæ³„éœ²å†…éƒ¨ HTTP GET
æŸ¥è¯¢ã€‚è¯¥æ¼æ´ä¼šåœ¨æœªç»ä»»ä½•èº«ä»½éªŒè¯çš„æƒ…å†µä¸‹æ³„éœ²æ—¥å¿—æ–‡ä»¶å¤¹çš„å†…éƒ¨è·¯å¾„ã€å…¶ä»–æ–‡ä»¶è·¯å¾„ã€ä½¿ç”¨è·å–æ•°æ®çš„å†…éƒ¨ç³»ç»ŸæŸ¥è¯¢ã€å†…éƒ¨ IP åœ°å€ã€å†…éƒ¨
IDã€é…ç½®ç›¸å…³ä¿¡æ¯ã€ç§äººæ–‡æ¡£ç­‰ä¿¡æ¯ã€‚é€šè¿‡åˆ©ç”¨æ­¤æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥æšä¸¾ç³»ç»Ÿä¸­å­˜åœ¨çš„æœ‰æ•ˆå†…éƒ¨ URLã€‚

#  **æ¼æ´é“¾**

ç°åœ¨æˆ‘æœ‰ä¸¤ä¸ªæ¼æ´ï¼š

1\. ç›²ç›® SSRFâ€”â€”å‘å†…éƒ¨å’Œå¤–éƒ¨ç³»ç»Ÿæäº¤ GET è¯·æ±‚  
2\. æœåŠ¡å™¨æ•æ„Ÿä¿¡æ¯æ³„éœ²â€”â€”æ—¥å¿—æ–‡ä»¶å¤¹çš„å†…éƒ¨è·¯å¾„ã€å…¶ä»–æ–‡ä»¶è·¯å¾„ã€ç”¨äºè·å–æ•°æ®çš„å†…éƒ¨ç³»ç»ŸæŸ¥è¯¢ã€å†…éƒ¨ IP åœ°å€ã€å†…éƒ¨ ID

æˆ‘åˆ›å»ºäº†ä¸€ä¸ªåœºæ™¯ï¼Œå±•ç¤ºäº†æ•æ„Ÿä¿¡æ¯æ³„æ¼å¦‚ä½•å¯¹å‘èµ·è·¯å¾„éå†å’ŒæœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€  (SSRF) ç­‰ç‰¹å®šæ”»å‡»æœ‰ç”¨ã€‚å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿè·çŸ¥ç½‘ç»œçš„å†…éƒ¨ IP
åœ°å€ï¼Œä»–/å¥¹å°±æ›´å®¹æ˜“å°†ç›®æ ‡å®šä¸ºå†…éƒ¨ç½‘ç»œä¸­çš„ç³»ç»Ÿã€‚

æˆ‘å°†ä¸¤ä¸ª PoC éƒ½æäº¤ç»™äº† Facebookï¼Œæˆ‘æ”¶åˆ°äº†å›å¤ï¼š

![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230301101242.png)

æˆ‘è§‚å¯Ÿåˆ°ç›² SSRF é”™è¯¯ç°åœ¨å·²è¢«ä¿®è¡¥ï¼ˆâ€œwikiScrapperâ€ä»»åŠ¡ä¸å†å¯è®¿é—®/æ³¨å†Œï¼‰ã€‚  
å—¯..é‚£ä¸å…¬å¹³

æˆ‘å›ç­”äº†ï¼š

![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230301101243.png)

æˆ‘æ”¶åˆ°å›å¤ï¼š

![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230301101244.png)

è¿æ°”ä¸å¥½

![]()

  

ç»è¿‡å‡ å¤©çš„ç ”ç©¶ï¼Œæˆ‘å‘ç°äº†å¦ä¸€ä¸ªç›² SSRFã€‚

  
ä» MicroStrategy web SDK çš„æºä»£ç ä¸­ï¼Œæˆ‘ç¡®è®¤å®ƒæ˜¯ä¸€ä¸ªå†…éƒ¨
SSRFã€‚åœ¨â€œcom.microstrategy.web.app.utils.usherâ€ç±»ä¸­ï¼Œæˆ‘è§‚å¯Ÿåˆ°å¤„ç†â€œserverURLâ€å‚æ•°çš„â€œvalidateServerURLâ€å‡½æ•°ã€‚â€œvalidateServerURLâ€å‡½æ•°å°†åœ¨å†…éƒ¨å‘æä¾›çš„
URL å‘é€ GET è¯·æ±‚ã€‚

![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230301101245.png)

![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230301101246.png)

æˆ‘ç”¨ Burp Collaborator URL æ›¿æ¢äº†â€œserverURLâ€å‚æ•°çš„å€¼å¹¶å‘é€äº† GET è¯·æ±‚ã€‚

![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230301101247.png)

å®ƒè§‚å¯Ÿåˆ° Burp Collaborator ç«‹å³ç‚¹å‡»ï¼Œå®ƒå°†æ˜¾ç¤ºæ”¶åˆ°è¯·æ±‚çš„IP åœ°å€â€œ 199.201.64.1 â€ã€‚è¿™è¡¨æ˜å­˜åœ¨ SSRF æ¼æ´ã€‚

æˆ‘è¯·æ±‚ä»–ä»¬å…è®¸æˆ‘æ‰§è¡Œæˆ‘ä¹‹å‰ç”µå­é‚®ä»¶ä¸­æè¿°çš„æ“ä½œã€‚  
ä»–ä»¬å›ç­”è¯´ï¼Œä»–ä»¬èƒ½å¤Ÿé‡ç°è¯¥é”™è¯¯ï¼Œå¹¶ä¸”æ­£åœ¨ç ”ç©¶è¡¥ä¸ã€‚ä»–ä»¬ä¼šå°½å¿«å‘æˆ‘é€šæŠ¥èµé‡‘å†³å®šã€‚  
å‡ å¤©åç»ˆäºæ”¶åˆ°å›å¤ï¼š

![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230301101248.png)

ç”±Facebookå¥–åŠ±æ¥ä¸‹æ¥æƒ³æµ‹è¯•ä¸‹MicroStrategy demo portalæ˜¯å¦å­˜åœ¨SSRFæ¼æ´ï¼Œç»“æœå‘ç°è¿™é‡Œä¹Ÿæœ‰è¿™ä¸ªæ¼æ´ã€‚æˆ‘èƒ½å¤Ÿä½¿ç”¨ AWS
å…ƒæ•°æ® API ä»ä»–æœåŠ¡å™¨è·å–ä¸€äº›æœ‰ç”¨çš„ä¿¡æ¯

![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230301101249.png)

ä½¿ç”¨SSRFå“åº”http://169.254.169.254/latest/user-data å…ƒæ•°æ® API è°ƒç”¨

æˆ‘å°†å…¶æŠ¥å‘Šç»™äº† MicroStrategy çš„å®‰å…¨å›¢é˜Ÿï¼Œæˆ‘æ”¶åˆ°äº†ä»¥ä¸‹å›å¤ï¼š

![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230301101250.png)

è·å¾—MicroStrategyçš„è®¤å¯å’Œå¥–åŠ±

#  **ç»“è®º**

è¯¥é—®é¢˜ç°å·²è§£å†³ã€‚è¿™æ˜¯ä¸€ç¯‡ç¨é•¿çš„æ–‡ç« ï¼Œä½†æˆ‘çš„ç›®çš„æ˜¯è®©æ‚¨å¾ˆå¥½åœ°ç†è§£å¦‚ä½•ç»“åˆæ‚¨çš„æ‰€æœ‰æŠ€èƒ½ï¼ˆä¾‹å¦‚å®‰å…¨ä»£ç å®¡æŸ¥ã€æšä¸¾å’Œè„šæœ¬çŸ¥è¯†ï¼‰æ¥æŸ¥æ‰¾å…³é”®æ¼æ´ã€‚

å½“æˆ‘ç¬¬ä¸€æ¬¡åœ¨ Facebook æœåŠ¡å™¨ä¸Šé‡åˆ°è¿™ä¸ªé”™è¯¯æ—¶ï¼Œæˆ‘è¯•å›¾å°†å…¶è½¬æ¢ä¸º RCEï¼Œä½†ä¸å¹¸çš„æ˜¯ä»–ä»¬å®æ–½äº†è‰¯å¥½çš„å®‰å…¨æªæ–½ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»è¿™ä¸ªæ¼æ´ä¸­æ€»å…±èµšäº†
31500ç¾å…ƒï¼ˆ1,000 ç¾å…ƒ + 30,000 ç¾å…ƒ + 500 ç¾å…ƒï¼‰ã€‚

>  **æ–‡ç« æ¥æºï¼šHACKå­¦ä¹ å‘€**

  

é»‘ç™½ä¹‹é“å‘å¸ƒã€è½¬è½½çš„æ–‡ç« ä¸­æ‰€æ¶‰åŠçš„æŠ€æœ¯ã€æ€è·¯å’Œå·¥å…·ä»…ä¾›ä»¥å®‰å…¨ä¸ºç›®çš„çš„å­¦ä¹ äº¤æµä½¿ç”¨ï¼Œä»»ä½•äººä¸å¾—å°†å…¶ç”¨äºéæ³•ç”¨é€”åŠç›ˆåˆ©ç­‰ç›®çš„ï¼Œå¦åˆ™åæœè‡ªè¡Œæ‰¿æ‹…ï¼

å¦‚ä¾µæƒè¯·ç§èŠæˆ‘ä»¬åˆ æ–‡  

  

 **END**

![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230301101251.png)

å¤šä¸€ä¸ªç‚¹åœ¨çœ‹![](https://raw.githubusercontent.com/tuchuang9/tc1/refs/heads/main/public/20230301101255.png)å¤šä¸€æ¡å°é±¼å¹²

é¢„è§ˆæ—¶æ ‡ç­¾ä¸å¯ç‚¹

å¾®ä¿¡æ‰«ä¸€æ‰«  
å…³æ³¨è¯¥å…¬ä¼—å·

[çŸ¥é“äº†](javascript:;)

å¾®ä¿¡æ‰«ä¸€æ‰«  
ä½¿ç”¨å°ç¨‹åº

****

[å–æ¶ˆ](javascript:void\(0\);) [å…è®¸](javascript:void\(0\);)

****

[å–æ¶ˆ](javascript:void\(0\);) [å…è®¸](javascript:void\(0\);)

ï¼š ï¼Œ ã€‚   è§†é¢‘ å°ç¨‹åº èµ ï¼Œè½»ç‚¹ä¸¤ä¸‹å–æ¶ˆèµ åœ¨çœ‹ ï¼Œè½»ç‚¹ä¸¤ä¸‹å–æ¶ˆåœ¨çœ‹

