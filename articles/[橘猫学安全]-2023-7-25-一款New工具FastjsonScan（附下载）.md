#  ä¸€æ¬¾Newå·¥å…·FastjsonScanï¼ˆé™„ä¸‹è½½ï¼‰

[ æ©˜çŒ«å­¦å®‰å…¨ ](javascript:void\(0\);)

**æ©˜çŒ«å­¦å®‰å…¨** ![]()

å¾®ä¿¡å· gh_af700ee13397

åŠŸèƒ½ä»‹ç» æ¯æ—¥ä¸€å¹²è´§ğŸ™‚

____

___å‘è¡¨äº_

æ”¶å½•äºåˆé›† #ç½‘ç»œå®‰å…¨æŠ€æœ¯ 209ä¸ª

# FastjsonScan

ä¸€æ¬¾æ¢æµ‹FastJsonæ¼æ´å·¥å…·

## 0x00 FastjsonScan now is public ğŸ‰ğŸ‰ğŸ‰

### WHAT?

FastjsonExpFrameworkä¸€å…±åˆ†ä¸ºæ¢æµ‹ã€åˆ©ç”¨ã€æ··æ·†ã€bypass JDKç­‰å¤šä¸ªæ¨¡å—ï¼Œè€ŒFastjsonScan
æ˜¯å…¶ä¸­ä¸€éƒ¨åˆ†ï¼Œé€šè¿‡æŠ¥é”™ã€è¯·æ±‚ã€ä¾èµ–åº“ç­‰æ¢æµ‹å®ç°å¤šæ–¹é¢å®šä½fastjsonç‰ˆæœ¬

### WHY?

ç°æœ‰çš„fastjsonæ‰«æå™¨æ— æ³•æ»¡è¶³è¿­ä»£é€Ÿåº¦å¦‚æ­¤å¿«çš„fastjsonç‰ˆæœ¬ï¼Œå¤§éƒ¨åˆ†æ‰«æå™¨æ—©å·²æ— äººç»´æŠ¤ï¼Œå·²ä¸é€‚é…é«˜ç‰ˆæœ¬ã€‚æˆ‘å°†æŒç»­ä¼˜åŒ–æ­¤ç³»åˆ—é¡¹ç›®ã€‚

### HOW?

ç›®å‰fastjsonScanæ”¯æŒ  
â˜‘ï¸æ”¯æŒæ‰¹é‡æ¥å£æ¢æµ‹  
â˜‘ï¸1.2.83åŠä»¥ä¸‹çš„åŒºé—´æ¢æµ‹(ä¸»è¦åˆ†ä¸º48,68,80ä¸‰å¤§å®‰å…¨ç‰ˆæœ¬)  
â˜‘ï¸æ”¯æŒæŠ¥é”™å›æ˜¾æ¢æµ‹  
â˜‘ï¸DNSå‡ºç½‘æ£€æµ‹  
â˜‘ï¸æ”¯æŒAutoTypeçŠ¶æ€æ£€æµ‹  
â˜‘ï¸ä¾èµ–åº“æ£€æµ‹  
â˜‘ï¸å»¶è¿Ÿæ£€æµ‹

### TODO

é€‚é…å†…ç½‘ç¯å¢ƒä¸‹çš„æ¢æµ‹  
é€‚é…webpackåšè‡ªåŠ¨åŒ–æ‰«æ  
å®Œå–„DNSå›æ˜¾æ¢æµ‹ä¾èµ–åº“çš„æ¢æµ‹  
å®Œå–„åœ¨61ç‰ˆæœ¬ä»¥ä¸Šå¹¶ä¸”ä¸å‡ºç½‘çš„æ£€æµ‹æ–¹å¼  
å®Œå–„å…¶ä»–ä¸åŒjsonè§£æåº“çš„æ¢æµ‹ å®Œå–„ç›¸å…³ä¾èµ–åº“æ£€æµ‹

### å¦‚æœåœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­æœ‰ä»»ä½•é—®é¢˜æ¬¢è¿æå‡ºissuesğŸ‘

### Demo

![]()æ‰«æç»“æœ  
![]()

## Usage

  

  *   *   *   * 

    
    
    FastjsonScan [-u] url [-f] urls.txt [-o] result.txt-u ç›®æ ‡urlï¼Œæ³¨æ„éœ€è¦åŠ ä¸Šhttp/https-f ç›®æ ‡urlæ–‡ä»¶ï¼Œå¯ä»¥æ‰«æå¤šæ¡url-o ç»“æœä¿å­˜æ–‡ä»¶ï¼Œé»˜è®¤åœ¨å½“å‰æ–‡ä»¶å¤¹ä¸‹çš„results.txtæ–‡ä»¶

## 0x01 Dev Notes

### 2022-09-05 0.5

Frameworkåˆ†ç¦»å‡ºscanæ¨¡å—

### 2022-09-05 0.4 beta

â˜‘ï¸é‡æ„ç‰ˆæœ¬æ¢æµ‹æ¨¡å—ï¼Œå°†åˆ¤æ–­fastjson,jackson,org.json,gsonåˆ†ç¦»å‡ºæ¥åšè¯†åˆ«æ¨¡å—TODO:  
åˆ©ç”¨dnslogæ¢æµ‹ä¾èµ–åº“  
åˆ©ç”¨æ¨¡å—ç¼–å†™

### 2022-09-04 0.35 beta

â˜‘ï¸ä¿®å¤äº†48ç‰ˆæœ¬çš„æ¢æµ‹payload,è¯¥payloadåœ¨è¿›è¡Œ80ç‰ˆæœ¬çš„payloadæ¢æµ‹ä¹‹åï¼Œä¼šè§¦å‘tojavaobjectä»è€Œå°†java.net.InetAddressç±»åŠ å…¥ç™½åå•ï¼Œå½“è¿›è¡Œç¬¬äºŒæ¬¡ç‰ˆæœ¬æ¢æµ‹æ—¶ä¼šäº§ç”Ÿè¯¯æŠ¥  
â˜‘ï¸ç‰ˆæœ¬æ£€æµ‹ä¼šä¼˜å…ˆåˆ¤æ–­AutoTypeæ˜¯å¦å¼€å¯ï¼Œå¦‚æœå¼€å¯åªèƒ½æ¨¡ç³ŠåŒºåˆ†48ä»¥ä¸‹åŠä»¥ä¸Š

### 2022-09-03 0.34 beta

â˜‘ï¸é‡æ„äº†ç‰ˆæœ¬æ¢æµ‹æ¨¡å—ï¼Œç”±ä¹‹å‰ç²¾ç¡®æ¢æµ‹åˆ†æˆäº†3å—ï¼ˆ48ï¼Œ68ï¼Œ80ï¼‰  
â˜‘ï¸é‡å†™äº†åˆ¤æ–­ç‰ˆæœ¬çš„é€»è¾‘  
â˜‘ï¸è¡¥å……äº†80ç‰ˆæœ¬ä¸83ç‰ˆæœ¬çš„æ¢æµ‹TODO:  
ç›®æ ‡ä¾èµ–åº“ç¯å¢ƒçš„æ¢æµ‹  
AutoTypeçš„çŠ¶æ€å¯¹ç‰ˆæœ¬æ¢æµ‹æœ‰å½±å“ï¼Œéœ€è¦åšå¤„ç†

### 2022-09-02 0.33 beta

â˜‘ï¸ä¿®æ”¹äº†å«æœ‰jacksonå­—æ®µçš„æŠ¥é”™æ£€æµ‹é€»è¾‘  
â˜‘ï¸DNSæ£€æµ‹æ–°å¢10ç§’çš„ç­‰å¾…æ—¶é—´ï¼Œé˜²æ­¢ç½‘ç»œåŸå› å¯¼è‡´è¯¯æŠ¥

### 2022-09-01 0.32 beta

â˜‘ï¸æ·»åŠ å¤šæ¡gadgetï¼Œéƒ¨åˆ†gadgetå¤ç°ä¸æˆåŠŸï¼Œæ ¹æ®ç›®æ ‡çš„ç¯å¢ƒæ·»åŠ   
â˜‘ï¸ä¿®æ”¹äº†å»¶è¿Ÿæ¢æµ‹çš„bug  
â˜‘ï¸æ·»åŠ äº†URLReaderçš„æ¢æµ‹é“¾

### 2022-08-07 0.31 beta

â˜‘ï¸å¢åŠ äº†å‡ æ¡gadgets

### 2022-08-06 0.3 beta

â˜‘ï¸å®Œæˆäº†AutoTypeæ¢æµ‹æ¨¡å—

### 2022-08-05 0.2 beta

â˜‘ï¸å®Œæˆäº†æ¢æµ‹æ¨¡å—çš„ä¸»è¦éƒ¨åˆ†ï¼šåŒ…æ‹¬æŠ¥é”™æ¢æµ‹ï¼ŒDNSæ¢æµ‹å’Œå»¶è¿Ÿæ¢æµ‹

## 0x02å‚è€ƒ

https://github.com/safe6Sec/Fastjson  
https://github.com/hosch3n/FastjsonVulns  
https://github.com/iSafeBlue/fastjson-autotype-bypass-demoä¸‹è½½åœ°å€ï¼š  
https://github.com/a1phaboy/FastjsonScan/releases/tag/v1.1å¦‚æœ‰ä¾µæƒï¼Œè¯·è”ç³»åˆ é™¤

 **æ¨èé˜…è¯»**

[å®æˆ˜|è®°ä¸€æ¬¡å¥‡å¦™çš„æ–‡ä»¶ä¸Šä¼ getshell](http://mp.weixin.qq.com/s?__biz=Mzg5OTY2NjUxMw==&mid=2247495718&idx=1&sn=e25bcb693e5a50988f4a7ccd4552c2e2&chksm=c04d7718f73afe0e282c778af8587446ff48cd88422701126b0b21fa7f5027c3cde89e0c3d6d&scene=21#wechat_redirect)  
[ã€Œ è¶…è¯¦ç»† | åˆ†äº«
ã€æ‰‹æŠŠæ‰‹æ•™ä½ å¦‚ä½•è¿›è¡Œå†…ç½‘æ¸—é€](http://mp.weixin.qq.com/s?__biz=Mzg5OTY2NjUxMw==&mid=2247495694&idx=1&sn=502c812024302566881bad63e01e98cb&chksm=c04d7730f73afe267fd4ef57fb3c74416b20db0ba8e6b03f0c1fd7785348860ccafc15404f24&scene=21#wechat_redirect)  
[ç¥å…µåˆ©å™¨ | siusiu-
æ¸—é€å·¥å…·ç®¡ç†å¥—ä»¶](http://mp.weixin.qq.com/s?__biz=Mzg5OTY2NjUxMw==&mid=2247495385&idx=1&sn=4d2d8456c27e058a30b147cb7ed51ab1&chksm=c04d69e7f73ae0f11b382cddddb4a07828524a53c0c2987d572967371470a48ad82ae96e7eb1&scene=21#wechat_redirect)  
[ä¸€æ¬¾åŠŸèƒ½å…¨é¢çš„XSSæ‰«æå™¨](http://mp.weixin.qq.com/s?__biz=Mzg5OTY2NjUxMw==&mid=2247495361&idx=1&sn=26077792908952c6279deeb2a19ebe37&chksm=c04d69fff73ae0e9f2e03dd8e347f35d660a7fd3d51b0f5e45c8c64afc90c0ee34c4251f9c80&scene=21#wechat_redirect)  
[å®æˆ˜ |
ä¸€æ¬¡åˆ©ç”¨å“¥æ–¯æ‹‰é©¬ç»•è¿‡å®å¡”waf](http://mp.weixin.qq.com/s?__biz=Mzg5OTY2NjUxMw==&mid=2247495331&idx=1&sn=94b63a0ec82de62191f0911a39b63b7a&chksm=c04d699df73ae08b946e4cf53ceea1bc7591dad0ce18a7ccffed33aa52adccb18b4b1aa78f4c&scene=21#wechat_redirect)  
[BurpCrypto:
ä¸‡èƒ½ç½‘ç«™å¯†ç çˆ†ç ´æµ‹è¯•å·¥å…·](http://mp.weixin.qq.com/s?__biz=Mzg5OTY2NjUxMw==&mid=2247495253&idx=1&sn=d4c46484a44892ef7235342d2763e6be&chksm=c04d696bf73ae07d0c16cff3317f6eb847df2251a9f2332bbe7de56cb92da53b206cd4100210&scene=21#wechat_redirect)  
[å¿«é€Ÿç­›é€‰çœŸå®IPå¹¶æ•´ç†ä¸ºCæ®µ --
æ£±çœ¼](http://mp.weixin.qq.com/s?__biz=Mzg5OTY2NjUxMw==&mid=2247495199&idx=1&sn=74c00ba76f4f6726107e2820daf7817a&chksm=c04d6921f73ae037efe92e051ac3978068d29e76b09cf5b0b501452693984f96baa9436457e4&scene=21#wechat_redirect)  
[è‡ªåŠ¨æ¢æµ‹ç«¯å£é¡ºä¾¿çˆ†ç ´å·¥å…·t14m4t](http://mp.weixin.qq.com/s?__biz=Mzg5OTY2NjUxMw==&mid=2247495141&idx=1&sn=084e8231c0495e91d1bd841e3f43b61c&chksm=c04d6adbf73ae3cdbb0a4cc754f78228772d6899b94d0ea6bb735b4b5ca03c51e7715b43d0af&scene=21#wechat_redirect)  
[æ¸—é€å·¥å…·ï½œæ— çŠ¶æ€å­åŸŸåçˆ†ç ´å·¥å…·ï¼ˆ1ç§’æ‰«160ä¸‡ä¸ªå­åŸŸï¼‰](http://mp.weixin.qq.com/s?__biz=Mzg5OTY2NjUxMw==&mid=2247495099&idx=1&sn=385764328aff5ec49acddab380721af0&chksm=c04d6a85f73ae393ffab22021839f5baec3802d495c34fb364cbdd9b7cb0cf642851e9527ba7&scene=21#wechat_redirect)  
 **æŸ¥çœ‹æ›´å¤šç²¾å½©å†…å®¹ï¼Œè¿˜è¯·å…³æ³¨** **æ©˜çŒ«å­¦å®‰å…¨ï¼š** **æ¯æ—¥åšæŒå­¦ä¹ ä¸åˆ†äº«ï¼Œè§‰å¾—æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©å¯åœ¨åº•éƒ¨ç»™ç‚¹ä¸ªâ€œ** **å†çœ‹ â€**

é¢„è§ˆæ—¶æ ‡ç­¾ä¸å¯ç‚¹

å¾®ä¿¡æ‰«ä¸€æ‰«  
å…³æ³¨è¯¥å…¬ä¼—å·

[çŸ¥é“äº†](javascript:;)

å¾®ä¿¡æ‰«ä¸€æ‰«  
ä½¿ç”¨å°ç¨‹åº

****

[å–æ¶ˆ](javascript:void\(0\);) [å…è®¸](javascript:void\(0\);)

****

[å–æ¶ˆ](javascript:void\(0\);) [å…è®¸](javascript:void\(0\);)

ï¼š ï¼Œ ã€‚   è§†é¢‘ å°ç¨‹åº èµ ï¼Œè½»ç‚¹ä¸¤ä¸‹å–æ¶ˆèµ åœ¨çœ‹ ï¼Œè½»ç‚¹ä¸¤ä¸‹å–æ¶ˆåœ¨çœ‹

